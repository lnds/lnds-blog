<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" crossorigin="anonymous"></script>
<script>
(function() {
    // Pre-process: convert double backslashes to single (for legacy wowchemy content)
    var sections = document.querySelectorAll('.page-section');
    sections.forEach(function(el) {
        el.innerHTML = el.innerHTML.replace(/\\\\([a-zA-Z{},])/g, '\\$1');
    });

    // Render math
    if (typeof renderMathInElement !== 'undefined') {
        renderMathInElement(document.body, {
            delimiters: [
                {left: '$$', right: '$$', display: true},
                {left: '$', right: '$', display: false}
            ],
            throwOnError: false
        });
    }
})();
</script>
