<!DOCTYPE html>
<html lang="es-cl" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>When The Heart Rules the Mind | La Naturaleza del Software</title>
<link rel="icon" href="/favicon.svg" sizes="any" type="image/svg+xml" /><meta property="og:url" content="http://localhost:1313/posts/2017/when-the-heart-rules-the-mind/">
  <meta property="og:site_name" content="La Naturaleza del Software">
  <meta property="og:title" content="When The Heart Rules the Mind">
  <meta property="og:description" content="Mother protect me,
protect me from myself
Si juntas a Steve Howe, ex guirarrista de Yes y Asia con Steve Hackett, ex guitarrista de Génesis, nada puede salir mal, ¿verdad? Es decir, son dos de los mejores guitarristas del rock progresivo inglés, sumemos a John Mover, ex baterista de Marillion, a Phil Spalding (quien entre otros trabajó con Mike Oldfield) y al frente al canta Max Bacon (ex Nightwing and Bronz), con todo ese talento junto el producto debería ser excepcional. Al menos en teoría.">
  <meta property="og:locale" content="es_cl">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2017-10-01T08:25:11-03:00">
    <meta property="article:modified_time" content="2017-10-01T08:25:11-03:00">
    <meta property="article:tag" content="Rock">
    <meta property="article:tag" content="Lenguajes De Programación">
    <meta property="article:tag" content="Desafíos">
    <meta property="article:tag" content="Go">
    <meta property="og:image" content="http://localhost:1313/posts/2017/when-the-heart-rules-the-mind/featured.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/posts/2017/when-the-heart-rules-the-mind/featured.png">
  <meta name="twitter:title" content="When The Heart Rules the Mind">
  <meta name="twitter:description" content="Mother protect me,
protect me from myself
Si juntas a Steve Howe, ex guirarrista de Yes y Asia con Steve Hackett, ex guitarrista de Génesis, nada puede salir mal, ¿verdad? Es decir, son dos de los mejores guitarristas del rock progresivo inglés, sumemos a John Mover, ex baterista de Marillion, a Phil Spalding (quien entre otros trabajó con Mike Oldfield) y al frente al canta Max Bacon (ex Nightwing and Bronz), con todo ese talento junto el producto debería ser excepcional. Al menos en teoría.">

    <link rel="stylesheet" href="/css/root.css">
    <link rel="stylesheet" href="/css/bundle.css">

      <script src="/js/bundle.js"></script><script defer src="/js/search/flexsearch.compact.64594b125f7b78bdf4fa8316955922bbebb1cd6baef3f16654bfca20309f18f8.js" integrity="sha256-ZFlLEl97eL30&#43;oMWlVkiu&#43;uxzWuu8/FmVL/KIDCfGPg="></script>
<script defer src="/js/search/search.1d980f84df11f3eb7c8c5f17f541d49a0611608df179dd74fa7f06225eb56ace.js" integrity="sha256-HZgPhN8R8&#43;t8jF8X9UHUmgYRYI3xed10&#43;n8GIl61as4="></script>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Spectral:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,200..800&family=Spectral:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel="stylesheet">

</head>
<body class="notransition">
  <div id="container">
    <header id="main-header"><div role="navigation" aria-label="Main">
  <div class="nav-left">
    <a href="http://localhost:1313/" style="color: inherit;">La Naturaleza del Software</a>
  </div>
  <div class="nav-right">
    <div style="position:absolute;width:0px;height:0px;">
      <div id="nav-dropdown-menu" class="hidden" href="#">
    <div class="nav-item">
      <a aria-current="true" class="ancestor" href="/posts/"
      >Posts</a>
    </div>
    <div class="nav-item">
      <a href="https://Newsletter.lnds.net"
      >Newsletter</a>
    </div>
    <div class="nav-item">
      <a href="/books/"
      >Books</a>
    </div>
    <div class="nav-item">
      <a href="/about/"
      >About</a>
    </div>
</div>
    </div>
    <a id="nav-dropdown-button" href="#"><svg width="20px" height="20px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M4 6H20M4 12H20M4 18H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</a>
    <div id="nav-menu">
    <div class="nav-item">
      <a aria-current="true" class="ancestor" href="/posts/"
      >Posts</a>
    </div>
    <div class="nav-item">
      <a href="https://Newsletter.lnds.net"
      >Newsletter</a>
    </div>
    <div class="nav-item">
      <a href="/books/"
      >Books</a>
    </div>
    <div class="nav-item">
      <a href="/about/"
      >About</a>
    </div>
</div>
    <a id="theme-switcher" href="#">
<svg class="light-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M12 3V4M12 20V21M4 12H3M6.31412 6.31412L5.5 5.5M17.6859 6.31412L18.5 5.5M6.31412 17.69L5.5 18.5001M17.6859 17.69L18.5 18.5001M21 12H20M16 12C16 14.2091 14.2091 16 12 16C9.79086 16 8 14.2091 8 12C8 9.79086 9.79086 8 12 8C14.2091 8 16 9.79086 16 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>

<svg class="dark-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M3.32031 11.6835C3.32031 16.6541 7.34975 20.6835 12.3203 20.6835C16.1075 20.6835 19.3483 18.3443 20.6768 15.032C19.6402 15.4486 18.5059 15.6834 17.3203 15.6834C12.3497 15.6834 8.32031 11.654 8.32031 6.68342C8.32031 5.50338 8.55165 4.36259 8.96453 3.32996C5.65605 4.66028 3.32031 7.89912 3.32031 11.6835Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</a>
  </div>
</div>
</header>
    <div class="flex grow">
      <div id="main-pane">
        <main id="main-content"><div class="single-header">
<ol class="breadcrumbs" itemscope itemtype="https://schema.org/BreadcrumbList">
    <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
      <a itemprop="item" href="http://localhost:1313/">
        <span itemprop="name">Home</span>
      </a>
      <meta itemprop="position" content='1' />
    </li>
    <span>&nbsp»&nbsp</span>
    <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
      <a itemprop="item" href="http://localhost:1313/posts/">
        <span itemprop="name">Posts</span>
      </a>
      <meta itemprop="position" content='2' />
    </li>
    <span>&nbsp»&nbsp</span>
</ol>
<h1>When The Heart Rules the Mind</h1><time class="dim" datetime="2017-10-01T08:25:11-03:00">October 1, 2017</time><div class="term-container"><div class="tag">
        <a href="http://localhost:1313/tags/rock/">#rock</a>
      </div><div class="tag">
        <a href="http://localhost:1313/tags/lenguajes-de-programaci%C3%B3n/">#lenguajes de programación</a>
      </div><div class="tag">
        <a href="http://localhost:1313/tags/desaf%C3%ADos/">#desafíos</a>
      </div><div class="tag">
        <a href="http://localhost:1313/tags/go/">#go</a>
      </div></ol></div>
  <section class="page-section"><blockquote>
<p>Mother protect me,<br>
protect me from myself</p></blockquote>
<p>Si juntas a Steve Howe, ex guirarrista de Yes y Asia con  Steve Hackett,
ex guitarrista de Génesis, nada puede salir mal, ¿verdad? Es decir, son
dos de los mejores guitarristas del rock progresivo inglés, sumemos a
John Mover, ex baterista de Marillion, a Phil Spalding (quien entre
otros trabajó con Mike Oldfield) y al frente al canta Max Bacon (ex
Nightwing and Bronz), con todo ese talento junto el producto debería ser
excepcional. Al menos en teoría.</p>
<figure><img src="https://d2dspjyoh5c79p.cloudfront.net/1539bfc9-a6ef-11e7-a030-2b5831f8ecb5-aa9f18b7"
    alt="Steve Hackett y Steve Howe"><figcaption>
      <p>Steve Hackett y Steve Howe</p>
    </figcaption>
</figure>

<p>Ese super grupo existió y se llamó GTR, y generó mucho ruido en 1985. El
nombre es simplemente Guitar sin las vocales, el nombre viene de la
restricción que impuso Howe, quien, molesto de la predominancia de los
teclados en Asia, impuso la restricción de que el grupo sólo ocuparía
guitarras. Claro que eran guitarras especiales con unos pickups para
sintetizadores Roland, que usan la vibración de las cuerdas para crear
señales MIDI que activan y operan sintetizadores. </p>
<p>Pero desde el principio tuvieron problemas, Howe insistía en que se
invirtiera tiempo de alta calidad en el estudio, mientras que Hackett
prefería un presupuesto más bajo en estudio e invertir más en
instrumentos y tecnología. La idea de Howe fue la que prevaleció y
resultó a la larga ser más cara, dejando al grupo endeudado. Esto fue
aprovechado por el manager Brian Lane (ex manager de Yes), para amarrar
un trato final que le aseguró la recuperación del dinero invertido.</p>
<p>El resultado final fue tan decepcionante, que el crítico J.D. Considine
publicó en la revista Musician, como única crítica al álbum debut, lo
siguiente: &ldquo;GTR - SHT&rdquo;.</p>
<p><img src="https://d2dspjyoh5c79p.cloudfront.net/bdd18d08-a6ce-11e7-a030-2b5831f8ecb5-aa9f18b7" alt=""></p>
<p>GTR salió de tour en 1986 por Norte América y Europa. Fue en los ensayos
que se reveló que la idea de no usar teclados era impracticable, puesto
que los sintetizadores conectados a las guitarras no tenían la calidad
requerida para un concierto en vivo, así que a regañadientes el grupo
tuvo que aceptar la incorporación de un tecladista en el escenario.
Además tuvieron que agregar canciones de Yes y Genesis para completar
los setlists de los conciertos.</p>
<h1 id="go-power-trio">Go Power Trio</h1>
<blockquote>
<p>When the heart rules the mind<br>
One look and love is blind<br>
When you want the dream to last<br>
Take a chance forget the past</p></blockquote>
<p><a href="https://golang.org/">El lenguaje de programación Go</a> es también el
producto de un super grupo, uno financiado por Google. Go fue diseñado
originalmente por Robert Griesemer, quien había trabajado en un
compilador de Java para HotSpot y en la máquina virtual V8 para
JavaScript, junto con Rob Pike, ex miembro de Bell Labs, uno de los
creadores del sistema operativo Plan 9 y del lenguaje Limbo y por último
el gran Ken Thompson, uno de los creadores del sistema operativo Unix y
el lenguaje C.</p>
<p>Así como Howe estaba harto de los teclados, Griesemmer, Pike y Thompson
estaban más que insatisfechos con la complejidad de C++. </p>
<p>Por fortuna el ensamble de Google tuvo mejor éxito que el de GTR, en
parte porque Pike y Thompson ya habían trabajado juntos, y porque
pudieron construir en muy poco tiempo una comunidad alrededor del
lenguaje (gracias al gentil auspicio de Google, por supuesto).</p>
<figure><img src="https://d2dspjyoh5c79p.cloudfront.net/4f0fa74b-a6fa-11e7-a030-2b5831f8ecb5-aa9f18b7"
    alt="Griesemer, Pike y Thompson"><figcaption>
      <p>Griesemer, Pike y Thompson</p>
    </figcaption>
</figure>

<p>El diseño de Go favorece la simplicidad, una sintaxis simple, que
permite un compilador muy rápido. Go es un lenguaje con tipos estáticos,
que permite el desarrollo de sistemas grandes y escalables.  Es un
lenguaje muy productivo y de fácil lectura para alguien acostumbrado a
lenguajes derivados de C. Su diseño está pensado para dar buen soporte a
aplicaciones de redes y multi proceso. </p>
<h2 id="objetos-en-go">Objetos en Go</h2>
<blockquote>
<p>Watching the actor,<br>
that takes the stage by storm</p></blockquote>
<p>Las características que sobresalen de Go son:</p>
<ul>
<li>Procesos livianos a través de las llamadas go-rutinas </li>
<li>Canales para implementar concurrencia usando parte del modelo
<a href="https://en.wikipedia.org/wiki/Communicating_sequential_processes">CSP</a></li>
<li>Interfaces, para poder implementar polimorfismo</li>
<li>En Go no hay herencia, aunque se puede implementar composición.</li>
</ul>
<p>Una de las particularidades en  Go, y que puede ser confusa al
principio, en mi opinión, es su modelo de programación de objetos. </p>
<p>Les voy a mostrar un ejemplo:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-golang" data-lang="golang"><span style="display:flex;"><span>    <span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;fmt&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Car</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">odometer</span> <span style="color:#66d9ef">int</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">NewCar</span>() <span style="color:#f92672">*</span><span style="color:#a6e22e">Car</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">p</span> <span style="color:#f92672">:=</span> new(<span style="color:#a6e22e">Car</span>)
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">odometer</span> = <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">p</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">c</span> <span style="color:#a6e22e">Car</span>) <span style="color:#a6e22e">forward</span>() {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">odometer</span> <span style="color:#f92672">+=</span> <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">c</span> <span style="color:#a6e22e">Car</span>) <span style="color:#a6e22e">showOdometer</span>() {
</span></span><span style="display:flex;"><span>       <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;odometer %d\n&#34;</span>, <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">odometer</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>       <span style="color:#a6e22e">car</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">NewCar</span>()
</span></span><span style="display:flex;"><span>       <span style="color:#a6e22e">car</span>.<span style="color:#a6e22e">forward</span>()
</span></span><span style="display:flex;"><span>       <span style="color:#a6e22e">car</span>.<span style="color:#a6e22e">forward</span>()
</span></span><span style="display:flex;"><span>       <span style="color:#a6e22e">car</span>.<span style="color:#a6e22e">showOdometer</span>()
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>Uno esperaría que este programa imprimiera: &ldquo;odoometer 20&rdquo;, pero no es
así, lo que hace es imprimir 0. Esta fue la causa de un bug cuando
implementé por primera vez mi solución al desafío 4 en Go.</p>
<p>En realidad, en Go los métodos son simplemente funciones, que reciben
sus argumentos por valor. Así que cuando hacemos:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>        <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">odometer</span> <span style="color:#f92672">+=</span> <span style="color:#ae81ff">10</span>
</span></span></code></pre></div><p>Estamos operando sobre la copia que recibió la función, los cambios se
perderán al retornar de la función. Así que la solución es que para
construir métodos que mutan un objeto se deben usar punteros:</p>
<p>Así que para resolver este problema debemos hacer:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>    <span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;fmt&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Car</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">odometer</span> <span style="color:#66d9ef">int</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">NewCar</span>() <span style="color:#f92672">*</span><span style="color:#a6e22e">Car</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">p</span> <span style="color:#f92672">:=</span> new(<span style="color:#a6e22e">Car</span>)
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">odometer</span> = <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">p</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">c</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">Car</span>) <span style="color:#a6e22e">forward</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">odometer</span> <span style="color:#f92672">+=</span> <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">c</span> <span style="color:#a6e22e">Car</span>) <span style="color:#a6e22e">showOdometer</span>() {
</span></span><span style="display:flex;"><span>       <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;odometer %d\n&#34;</span>, <span style="color:#a6e22e">c</span>.<span style="color:#a6e22e">odometer</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">car</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">NewCar</span>()
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">car</span>.<span style="color:#a6e22e">forward</span>()
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">car</span>.<span style="color:#a6e22e">forward</span>()
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">car</span>.<span style="color:#a6e22e">showOdometer</span>()
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>Este es un modelo de paso de argumentos muy parecido a lo que ocurre en
lenguajes antiguos, como C, Pascal, o incluso Algol, bastante anticuado,
en mi opinión, que supongo viene de Pike y Thompson, como muchas otras
cosas idiosincráticas del lenguaje, por ejemplo, el hecho de no
implementar estructuras de datos genéricas (o templates).</p>
<h2 id="huffman-en-go">Huffman en Go</h2>
<p>Esta es la quinta parte del desafío 4, en nuestra serie de
<a href="/blog/lnds/2016/01/09/esos-raros-lenguajes-nuevos">&ldquo;esos raros lenguajes nuevos&rdquo;</a>.</p>
<p>Resolver este problema en Go fue relativamente sencillo comparado con la
solución en Rust. Aunque debo decir que al ejecutar por primera vez el
programa en Go tuve un error de acceso a un puntero null, algo que es
imposible de lograr en Rust, y ahí fue donde gasté más tiempo, hasta que
entendí cómo maneja sus argumentos los métodos en
Go.</p>
<p>El bug se encontraba en el método BuildHuffTree:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>    <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">BuildHuffTree</span>(<span style="color:#a6e22e">reader</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">BitInputStream</span>) <span style="color:#f92672">*</span><span style="color:#a6e22e">HuffTree</span> {
</span></span><span style="display:flex;"><span>     <span style="color:#a6e22e">p</span> <span style="color:#f92672">:=</span> new(<span style="color:#a6e22e">HuffTree</span>)
</span></span><span style="display:flex;"><span>       <span style="color:#a6e22e">freqs</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">calcFrecuencies</span>(<span style="color:#a6e22e">reader</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">heap</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">NewHeap</span>(<span style="color:#a6e22e">MAX_SYMBOLS</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">s</span>, <span style="color:#a6e22e">f</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span>(<span style="color:#a6e22e">freqs</span>) {
</span></span><span style="display:flex;"><span>           <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">f</span> &gt; <span style="color:#ae81ff">0</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">heap</span>.<span style="color:#a6e22e">Insert</span>(<span style="color:#a6e22e">NewLeaf</span>(uint(<span style="color:#a6e22e">f</span>), byte(<span style="color:#a6e22e">s</span>)))
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>       }
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">heap</span>.<span style="color:#a6e22e">Size</span>() &gt; <span style="color:#ae81ff">1</span> {
</span></span><span style="display:flex;"><span>         <span style="color:#a6e22e">l</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">heap</span>.<span style="color:#a6e22e">Extract</span>()
</span></span><span style="display:flex;"><span>         <span style="color:#a6e22e">r</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">heap</span>.<span style="color:#a6e22e">Extract</span>()
</span></span><span style="display:flex;"><span>         <span style="color:#a6e22e">heap</span>.<span style="color:#a6e22e">Insert</span>(<span style="color:#a6e22e">NewNode</span>(<span style="color:#a6e22e">l</span>.<span style="color:#a6e22e">Freq</span>()<span style="color:#f92672">+</span><span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">Freq</span>(), <span style="color:#a6e22e">l</span>, <span style="color:#a6e22e">r</span>))
</span></span><span style="display:flex;"><span>       }
</span></span><span style="display:flex;"><span>       <span style="color:#a6e22e">tree</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">heap</span>.<span style="color:#a6e22e">Extract</span>()
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">codes</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">buildCodes</span>(<span style="color:#a6e22e">tree</span>)
</span></span><span style="display:flex;"><span>       <span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">tree</span> = <span style="color:#a6e22e">tree</span>
</span></span><span style="display:flex;"><span>       <span style="color:#a6e22e">p</span>.<span style="color:#a6e22e">codes</span> = <span style="color:#a6e22e">codes</span>
</span></span><span style="display:flex;"><span>     <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">p</span>
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>Originalmente Heap.Insert() no recibía un puntero a la struct Heap, así
que yo esperaba que Insert() fuera mutando la estructura, lo que no
sucedió, pues estaba acostumbrado a los modelos de muchos lenguajes
modernos, que manejan los objetos como referencias. </p>
<p>La otra característica que usé en esta solución fueron las Interfaces de
Go. Esto permite crear una solución orientada al objeto, no tan
funcional como la de Rust. A diferencia de Rust, en Go sí existen
valores nulos (por eso que mi programa se cayó la primera vez).</p>
<p>En nuestro caso la interfaz a implementar fue Tree:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>    <span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Tree</span> <span style="color:#66d9ef">interface</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">Freq</span>() <span style="color:#66d9ef">uint</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">WriteTo</span>(<span style="color:#a6e22e">writer</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">BitOutputStream</span>)
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">sDumpCodes</span>(<span style="color:#a6e22e">codes</span> []<span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">prefix</span> <span style="color:#66d9ef">string</span>)
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">ReadChar</span>(<span style="color:#a6e22e">reader</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">BitInputStream</span>) <span style="color:#66d9ef">byte</span>
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>En Go no hay herencia, pero sí polimorfismo, a través de interfaces.
Cualquier estructura que implemente los métodos definidos en la
interface se dice que tiene el mismo tipo. Esto se llama técnicamente,
polimorfismo de subtipos implícitos, o coloquialmente,
<a href="https://en.wikipedia.org/wiki/Duck_typing">&ldquo;duck typing&rdquo;</a>(&ldquo;si camina como
pato, grazna como pato, entonces ¡es un pato!&rdquo;). Esta es una
característica típica de los lenguajes dinámicos, pero es muy agradable
encontrarla en un lenguaje estático como Go.</p>
<p>Así que para resolver nuestro problema declaramos el modelo del árbol de
Huffman usando dos tipos: Leaf y Node del siguiente modo:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>    <span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Leaf</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">freq</span> <span style="color:#66d9ef">uint</span>
</span></span><span style="display:flex;"><span>       <span style="color:#a6e22e">symbol</span> <span style="color:#66d9ef">byte</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Node</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">freq</span> <span style="color:#66d9ef">uint</span>
</span></span><span style="display:flex;"><span>       <span style="color:#a6e22e">left</span> <span style="color:#a6e22e">Tree</span>
</span></span><span style="display:flex;"><span>       <span style="color:#a6e22e">right</span> <span style="color:#a6e22e">Tree</span>
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>Y por cada una implementamos los métodos de la interface:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>    <span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">l</span> <span style="color:#a6e22e">Leaf</span>) <span style="color:#a6e22e">Freq</span>() <span style="color:#66d9ef">uint</span> {
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">l</span>.<span style="color:#a6e22e">freq</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">n</span> <span style="color:#a6e22e">Node</span>) <span style="color:#a6e22e">Freq</span>() <span style="color:#66d9ef">uint</span> {
</span></span><span style="display:flex;"><span>     <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">n</span>.<span style="color:#a6e22e">freq</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">l</span> <span style="color:#a6e22e">Leaf</span>) <span style="color:#a6e22e">WriteTo</span>(<span style="color:#a6e22e">writer</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">BitOutputStream</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">writer</span>.<span style="color:#a6e22e">WriteBit</span>(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">writer</span>.<span style="color:#a6e22e">WriteByte</span>(uint16(<span style="color:#a6e22e">l</span>.<span style="color:#a6e22e">symbol</span>))
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">n</span> <span style="color:#a6e22e">Node</span>) <span style="color:#a6e22e">WriteTo</span>(<span style="color:#a6e22e">writer</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">BitOutputStream</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">writer</span>.<span style="color:#a6e22e">WriteBit</span>(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">n</span>.<span style="color:#a6e22e">left</span>.<span style="color:#a6e22e">WriteTo</span>(<span style="color:#a6e22e">writer</span>)
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">n</span>.<span style="color:#a6e22e">right</span>.<span style="color:#a6e22e">WriteTo</span>(<span style="color:#a6e22e">writer</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">l</span> <span style="color:#a6e22e">Leaf</span>) <span style="color:#a6e22e">DumpCodes</span>(<span style="color:#a6e22e">codes</span> []<span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">prefix</span> <span style="color:#66d9ef">string</span>) {
</span></span><span style="display:flex;"><span>     <span style="color:#a6e22e">codes</span>[<span style="color:#a6e22e">l</span>.<span style="color:#a6e22e">symbol</span>] = <span style="color:#a6e22e">prefix</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">n</span> <span style="color:#a6e22e">Node</span>) <span style="color:#a6e22e">DumpCodes</span>(<span style="color:#a6e22e">codes</span> []<span style="color:#66d9ef">string</span>, <span style="color:#a6e22e">prefix</span> <span style="color:#66d9ef">string</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">n</span>.<span style="color:#a6e22e">left</span>.<span style="color:#a6e22e">DumpCodes</span>(<span style="color:#a6e22e">codes</span>, <span style="color:#a6e22e">prefix</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;0&#34;</span>)
</span></span><span style="display:flex;"><span>     <span style="color:#a6e22e">n</span>.<span style="color:#a6e22e">right</span>.<span style="color:#a6e22e">DumpCodes</span>(<span style="color:#a6e22e">codes</span>, <span style="color:#a6e22e">prefix</span><span style="color:#f92672">+</span><span style="color:#e6db74">&#34;1&#34;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">l</span> <span style="color:#a6e22e">Leaf</span>) <span style="color:#a6e22e">ReadChar</span>(<span style="color:#a6e22e">reader</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">BitInputStream</span>) <span style="color:#66d9ef">byte</span> {
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">l</span>.<span style="color:#a6e22e">symbol</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">func</span> (<span style="color:#a6e22e">n</span> <span style="color:#a6e22e">Node</span>) <span style="color:#a6e22e">ReadChar</span>(<span style="color:#a6e22e">reader</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">BitInputStream</span>) <span style="color:#66d9ef">byte</span> {
</span></span><span style="display:flex;"><span>     <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">reader</span>.<span style="color:#a6e22e">ReadBool</span>() {
</span></span><span style="display:flex;"><span>          <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">n</span>.<span style="color:#a6e22e">right</span>.<span style="color:#a6e22e">ReadChar</span>(<span style="color:#a6e22e">reader</span>)
</span></span><span style="display:flex;"><span>      } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">n</span>.<span style="color:#a6e22e">left</span>.<span style="color:#a6e22e">ReadChar</span>(<span style="color:#a6e22e">reader</span>)
</span></span><span style="display:flex;"><span>       }
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>Lo interesante es que no tuvimos que decir que Leaf o Node implementan
Tree, para Go esto sólo importa cuando tratamos de hacer pasar alguna de
estas variables como un Tree, como por ejemplo, en el caso de la función
readTree().</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span>    <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">readTree</span>(<span style="color:#a6e22e">reader</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">BitInputStream</span>) <span style="color:#a6e22e">Tree</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">flag</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">reader</span>.<span style="color:#a6e22e">ReadBool</span>()
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">flag</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">NewLeaf</span>(<span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">reader</span>.<span style="color:#a6e22e">ReadChar</span>())
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>         <span style="color:#a6e22e">l</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">readTree</span>(<span style="color:#a6e22e">reader</span>)
</span></span><span style="display:flex;"><span>           <span style="color:#a6e22e">r</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">readTree</span>(<span style="color:#a6e22e">reader</span>)
</span></span><span style="display:flex;"><span>           <span style="color:#66d9ef">return</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">NewNode</span>(<span style="color:#ae81ff">0</span>, <span style="color:#a6e22e">l</span>, <span style="color:#a6e22e">r</span>)
</span></span><span style="display:flex;"><span>     }
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>Esta función devuelve algún objeto que implemente Tree, tanto Leaf como
Node cumplen esta condición, así que el código es válido.</p>
<h2 id="go-o-no-go">Go o no Go</h2>
<blockquote>
<p>Seasons will change<br>
You must move on<br>
Follow your dream</p></blockquote>
<p>Go es un lenguaje muy poderoso, y con características interesantes. Es
fácil de aprender, tiene una complejidad moderada, es muy fácil ser
productivo en Go, pero tiene ciertas idiosincracias que encuentro
molestas.</p>
<p>En particular no me gusta el manejo de excepciones, que obliga a llenar
el código de ifs, para verificar el resultado de cada operación
peligrosa. En este sentido, Rust es más elegante al administrar los
errores en monads, como Option o Result, las que se pueden componer. 
En este sentido Go es bastante primitivo. Aunque no tanto como C.</p>
<p>El polimorfismo en Go es elegante, pero sospecho que en una base de
código de muchas lineas puede llegar a ser engorroso de manejar. Es una
lástima que no soporte programación de estructuras de datos genéricas.</p>
<p>Go ha ganado mucho momentum, se ha vuelto un lenguaje popular entre
programadores aburridos de Java o de C++. No sabemos si los reemplazará,
pero sospecho que seguirá ganando momentum, y será más popular que Rust,
en ciertos ámbitos, porque definitivamente es mucho más fácil de
aprender. </p>
<p>Si estás aburrido de Java o de C++, definitivamente este es un lenguaje
que te recomiendo aprender. </p>
<p>Debo confesar que me sentía exceptico con respecto a Go, pero después de
este ejercicio me parece que es un lenguaje agradable. Me gustaría que
adoptara más aspectos funcionales, y que resuelva algunos issues con la
programación concurrente (de los que hablaremos en otro desafío). </p>
<p>Pero a veces no hay que dejar que el corazón gobierne a la mente, el
hecho de que mis primeras experiencias con Go no hayan sido agradables,
y que no tenga características que me gustan, no quita el hecho de que
Go es un lenguaje bastante bueno. Así que vamos a darle más
oportunidades a Go, creo que me sorprenderá gratamente.</p>
<p>El código fuente está, como siempre, en mi repositorio
GitHub: <a href="https://github.com/lnds/9d9l/tree/master/desafio4/go">https://github.com/lnds/9d9l/tree/master/desafio4/go</a></p>
<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/ARERFbiqCfk?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"></iframe>
    </div>

<h2 id="fuentes"><strong>Fuentes</strong>:</h2>
<p>Página en wikipeda sobre
GTR: <a href="https://en.wikipedia.org/wiki/GTR%5C_(band)">https://en.wikipedia.org/wiki/GTR\_(band)</a></p>
<p>Página oficial de Go: <a href="https://golang.org/">https://golang.org/</a></p>
<p><a href="http://amzn.to/2xTvy3b">El libro The Go Programming Language</a>, de Alan
Donovan y Brian Kernighan.</p>
</section></main>
        <footer id="main-footer"><div class="footer">
  <a href="#">Scroll to Top</a>
  <div class="footer-copyright">
    <div class="dim">© 2025 Eduardo Díaz</div>
    <div>Made with ❤️ and powered by <a href="https://github.com/math-queiroz/rusty-typewriter" target="_blank">Rusty Typewriter</a> theme for <a href="https://gohugo.io/" target="_blank">Hugo</a></div>
  </div>
</div>
</footer>
      </div><aside id="side-pane" class="side-sticky"><div class="side-details">
    <span>1851 words</span>
    <span>11 - 15 minutes read</span></div><h3>Table Of Contents</h3><nav id="TableOfContents">
  <ul>
    <li><a href="#objetos-en-go">Objetos en Go</a></li>
    <li><a href="#huffman-en-go">Huffman en Go</a></li>
    <li><a href="#go-o-no-go">Go o no Go</a></li>
    <li><a href="#fuentes"><strong>Fuentes</strong>:</a></li>
  </ul>
</nav><h3>Attachments</h3>
    <ul><li><a href="http://localhost:1313/posts/2017/when-the-heart-rules-the-mind/featured.png">featured.png</a></li></ul><h3>Related</h3>
    <ul><li><a href="/posts/2016/como-obtener-el-reporte-del-clima/">Cómo obtener el reporte del clima</a></li><li><a href="/posts/2016/chubascos-de-ligera-intensidad/">Chubascos de ligera intensidad</a></li><li><a href="/posts/2016/reporte-del-clima/">Reporte del Clima</a></li><li><a href="/posts/2017/red-barcheta/">Red Barchetta</a></li><li><a href="/posts/2017/occams-razor/">Occam&#39;s Razor</a></li></ul></aside></div>
  </div>
</body>
</html>
