<!DOCTYPE html>
<html lang="es-cl" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Zig Zag | La Naturaleza del Software</title>
<link rel="icon" href="/favicon.svg" sizes="any" type="image/svg+xml" /><meta property="og:url" content="http://localhost:1313/posts/2011/zig-zag/">
  <meta property="og:site_name" content="La Naturaleza del Software">
  <meta property="og:title" content="Zig Zag">
  <meta property="og:description" content="Han habido varias contribuciones al desafío del Zig Zag, si todavía no lo has leido, y te animas a contestar el test, entonces antes de seguir lee el desafío e intenta resolverlo.
La solución más concisa que conozco aparece en el sitio Rosseta Code, está escrita en el lenguaje J y es la siguiente:
($ [: /:@; &lt;@|.`&lt;/.@i.)@,~ 5 Increible, ¿verdad? En este caso es la solución para una matriz de 5 x 5. Hay una explicación de ese código acá, pero antes de que emprendan la tarea de tratar de entenderla veamos que respondieron algunos lectores y después le voy a mostrar mi solución.">
  <meta property="og:locale" content="es_cl">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2011-01-11T08:25:11-03:00">
    <meta property="article:modified_time" content="2011-01-11T08:25:11-03:00">
    <meta property="article:tag" content="Programación">
    <meta property="article:tag" content="Desafíos">
    <meta property="article:tag" content="Educación">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Zig Zag">
  <meta name="twitter:description" content="Han habido varias contribuciones al desafío del Zig Zag, si todavía no lo has leido, y te animas a contestar el test, entonces antes de seguir lee el desafío e intenta resolverlo.
La solución más concisa que conozco aparece en el sitio Rosseta Code, está escrita en el lenguaje J y es la siguiente:
($ [: /:@; &lt;@|.`&lt;/.@i.)@,~ 5 Increible, ¿verdad? En este caso es la solución para una matriz de 5 x 5. Hay una explicación de ese código acá, pero antes de que emprendan la tarea de tratar de entenderla veamos que respondieron algunos lectores y después le voy a mostrar mi solución.">

    <link rel="stylesheet" href="/css/root.css">
    <link rel="stylesheet" href="/css/bundle.css">

      <script src="/js/bundle.js"></script><script defer src="/js/search/flexsearch.compact.64594b125f7b78bdf4fa8316955922bbebb1cd6baef3f16654bfca20309f18f8.js" integrity="sha256-ZFlLEl97eL30&#43;oMWlVkiu&#43;uxzWuu8/FmVL/KIDCfGPg="></script>
<script defer src="/js/search/search.1d980f84df11f3eb7c8c5f17f541d49a0611608df179dd74fa7f06225eb56ace.js" integrity="sha256-HZgPhN8R8&#43;t8jF8X9UHUmgYRYI3xed10&#43;n8GIl61as4="></script>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Spectral:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,200..800&family=Spectral:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel="stylesheet">

</head>
<body class="notransition">
  <div id="container">
    <header id="main-header"><div role="navigation" aria-label="Main">
  <div class="nav-left">
    <a href="http://localhost:1313/" style="color: inherit;">La Naturaleza del Software</a>
  </div>
  <div class="nav-right">
    <div style="position:absolute;width:0px;height:0px;">
      <div id="nav-dropdown-menu" class="hidden" href="#">
    <div class="nav-item">
      <a aria-current="true" class="ancestor" href="/posts/"
      >Posts</a>
    </div>
    <div class="nav-item">
      <a href="https://Newsletter.lnds.net"
      >Newsletter</a>
    </div>
    <div class="nav-item">
      <a href="/books/"
      >Books</a>
    </div>
    <div class="nav-item">
      <a href="/about/"
      >About</a>
    </div>
</div>
    </div>
    <a id="nav-dropdown-button" href="#"><svg width="20px" height="20px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M4 6H20M4 12H20M4 18H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</a>
    <div id="nav-menu">
    <div class="nav-item">
      <a aria-current="true" class="ancestor" href="/posts/"
      >Posts</a>
    </div>
    <div class="nav-item">
      <a href="https://Newsletter.lnds.net"
      >Newsletter</a>
    </div>
    <div class="nav-item">
      <a href="/books/"
      >Books</a>
    </div>
    <div class="nav-item">
      <a href="/about/"
      >About</a>
    </div>
</div>
    <a id="theme-switcher" href="#">
<svg class="light-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M12 3V4M12 20V21M4 12H3M6.31412 6.31412L5.5 5.5M17.6859 6.31412L18.5 5.5M6.31412 17.69L5.5 18.5001M17.6859 17.69L18.5 18.5001M21 12H20M16 12C16 14.2091 14.2091 16 12 16C9.79086 16 8 14.2091 8 12C8 9.79086 9.79086 8 12 8C14.2091 8 16 9.79086 16 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>

<svg class="dark-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M3.32031 11.6835C3.32031 16.6541 7.34975 20.6835 12.3203 20.6835C16.1075 20.6835 19.3483 18.3443 20.6768 15.032C19.6402 15.4486 18.5059 15.6834 17.3203 15.6834C12.3497 15.6834 8.32031 11.654 8.32031 6.68342C8.32031 5.50338 8.55165 4.36259 8.96453 3.32996C5.65605 4.66028 3.32031 7.89912 3.32031 11.6835Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</a>
  </div>
</div>
</header>
    <div class="flex grow">
      <div id="main-pane">
        <main id="main-content"><div class="single-header">
<ol class="breadcrumbs" itemscope itemtype="https://schema.org/BreadcrumbList">
    <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
      <a itemprop="item" href="http://localhost:1313/">
        <span itemprop="name">Home</span>
      </a>
      <meta itemprop="position" content='1' />
    </li>
    <span>&nbsp»&nbsp</span>
    <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
      <a itemprop="item" href="http://localhost:1313/posts/">
        <span itemprop="name">Posts</span>
      </a>
      <meta itemprop="position" content='2' />
    </li>
    <span>&nbsp»&nbsp</span>
</ol>
<h1>Zig Zag</h1><time class="dim" datetime="2011-01-11T08:25:11-03:00">January 11, 2011</time><div class="term-container"><div class="tag">
        <a href="http://localhost:1313/tags/programaci%C3%B3n/">#programación</a>
      </div><div class="tag">
        <a href="http://localhost:1313/tags/desaf%C3%ADos/">#desafíos</a>
      </div><div class="tag">
        <a href="http://localhost:1313/tags/educaci%C3%B3n/">#educación</a>
      </div></ol></div>
  <section class="page-section"><p>Han habido varias contribuciones al desafío del Zig Zag, si todavía no
lo has leido, y te animas a contestar el test, entonces antes de
seguir <a href="/blog/2011/01/un-test-mas-dificil.html">lee el desafío</a> e
intenta resolverlo.</p>
<p>La solución más concisa que conozco aparece en el sitio <a href="http://rosettacode.org/wiki/Zig-zag_matrix">Rosseta
Cod</a>e, está escrita en el
<a href="http://www.jsoftware.com/">lenguaje J</a> y es la siguiente:</p>
<blockquote>
<pre><code> ($ [: /:@; &lt;@|.`&lt;/.@i.)@,~ 5
</code></pre></blockquote>
<p>Increible, ¿verdad? En este caso es la solución para una matriz de 5 x 5. Hay una explicación de ese código
<a href="http://rosettacode.org/wiki/Talk:Zig_Zag#reading_the_J_examples">acá</a>,
pero antes de que emprendan la tarea de tratar de entenderla veamos que
respondieron algunos lectores y después le voy  a mostrar mi solución.</p>
<p>Si tuviera que elegir 3 finalistas me gustan las soluciones de  de <a href="/blog/2011/01/un-test-mas-dificil.html#comment-959">Luis
Cárdenas</a>
(en perl), la de <a href="http://code.activestate.com/recipes/577536-un-arreglo-zig-zag-es-un-arreglo-cuadrado-de-los-p/">Javier
Rovegno</a>
(en python) y la de <a href="https://gist.github.com/772690/b5ca761dd6d7919790ea7103f70c430d217da3b1">Francisco
Rojas</a>
(en Java). En particular, creo que la más sucinta es la de Francisco,
Luis hizo una optimización interesante y queda en segundo lugar.</p>
<p>La solución de Javier es representativa de la estrategia más común, que
es usar una suerte de cursor que indica hacia donde hacer la siguiente
movida, las otras soluciones siguen ese esquema, pero la de Javier me
parece las más legible de las de este tipo.</p>
<p>La solución de Francisco Rojas me sorprendió por su brevedad, 28 lineas
en Java. La clave está en que Francisco intuyó una propiedad de las
diagonales y las antidiagonales, que vamos a aclarar en breve.</p>
<p>Ahora les voy a explicar como yo solucioné el problema, esta solución no
necesariamente es la más óptima (hay varias soluciones mejores en
<a href="http://rosettacode.org/wiki/Zig-zag_matrix">Rosseta Code</a>), pero tiene
dos características interesantes, no hay ningún if en el algoritmo, y
usa un arreglo de una dimensión para simular la matriz.</p>
<p>El código completo, escrito en C++, va más abajo, acá van las dos
funciones que implementan el algoritmo:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c++" data-lang="c++"><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">zigzag</span>(<span style="color:#66d9ef">int</span><span style="color:#f92672">*</span> array, <span style="color:#66d9ef">int</span> n)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> c <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> d <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>n;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> k <span style="color:#f92672">=</span> n;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> n2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>n;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> z;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (z <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>; z <span style="color:#f92672">&lt;</span> n; z<span style="color:#f92672">++</span>, d <span style="color:#f92672">=</span> <span style="color:#f92672">-</span>d, k <span style="color:#f92672">=</span> n<span style="color:#f92672">/</span>k)
</span></span><span style="display:flex;"><span>        c <span style="color:#f92672">=</span> run_diag(array, z<span style="color:#f92672">*</span>k, z<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>, d, c);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (; z <span style="color:#f92672">&lt;</span> n2; z<span style="color:#f92672">++</span>, d <span style="color:#f92672">=</span> <span style="color:#f92672">-</span>d, k <span style="color:#f92672">=</span> n<span style="color:#f92672">/</span>k)
</span></span><span style="display:flex;"><span>        c <span style="color:#f92672">=</span> run_diag(array, z<span style="color:#f92672">*</span>k<span style="color:#f92672">+</span>d<span style="color:#f92672">*</span>(z<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>n), n2<span style="color:#f92672">-</span>(z<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>), d, c);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">run_diag</span>(<span style="color:#66d9ef">int</span><span style="color:#f92672">*</span> array, <span style="color:#66d9ef">int</span> base, <span style="color:#66d9ef">int</span> top, <span style="color:#66d9ef">int</span> delta, <span style="color:#66d9ef">int</span> cont)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, l <span style="color:#f92672">=</span> base; i <span style="color:#f92672">&lt;</span> top; i<span style="color:#f92672">++</span>, l <span style="color:#f92672">+=</span> delta)
</span></span><span style="display:flex;"><span>            array[l] <span style="color:#f92672">=</span> cont<span style="color:#f92672">++</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> cont;
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>Para entender esto fíjense en la siguiente figura:</p>
<figure><img src="/posts/2011/zig-zag/diagonales_zigzag.png"
    alt="Diagonales y Antidiagonales"><figcaption>
      <p>Diagonales y Antidiagonales</p>
    </figcaption>
</figure>

<p>Lo que hace esta figura es escribir en cada cuadrado la suma de sus
coordenadas. En la figura las antidiagonales son blancas, y las
diagonales son de colores. Las diagonales  &ldquo;suben&rdquo; y las
antidiagonales &ldquo;bajan&rdquo;, si se fijan las diagonales son pares, y las
antidiagonales son impares.</p>
<p>Acá está el cuadrado zig zag de 6x6:</p>
<figure><img src="/posts/2011/zig-zag/matriz6x6.png"
    alt="Zig Zag de 6x6"><figcaption>
      <p>Zig Zag de 6x6</p>
    </figcaption>
</figure>

<p>Con esto se puede optimizar varios de los algoritmos que propusieron los
lectores.</p>
<p>El paso siguiente es que yo considero que voy a usar un arreglo de una
sola dimensión, entonces si recorriera la matriz como arreglo cada
coordenada esta dada por un número correlativo:</p>
<p><img src="zigzag_arreglo.png" alt="arreglo"></p>
<p>Por lo tanto, si recorriera la matriz a lo largo de las diagonales y
antidiagonales, para una matriz de N x N tendré 2N-1 diagonales que
recorrer, y por cada diagonal se recorreran las casillas en el orden que
sale en la figura:</p>
<p><img src="recorrido.png" alt=""></p>
<p>En esta figura z es la diagonal (para una matriz de 6x6 son 11 diagonales,
numeradas de 0 a 10), f y c son las filas y columnas iniciales de la
diagonales, b indica la base, o primer indice de la diagonal.</p>
<p>Veamos la diagonal 4, como es diagonal entonces &ldquo;sube&rdquo;, por lo tanto
parte de un indice alto (24) y termina en un indice bajo (4). La
antidiagonal 5 &ldquo;baja&rdquo;, por lo tanto parte de un indice bajo (5) y
termina en un índice alto (30). Por lo tanto en el caso de las
diagonales el paso (delta) es negativo y vale -5 (1-N). En el caso de
las antidiagonales el paso es positivo y vale 5 (N-1). Esto explica la
variable d que cambia de signo en los dos loops.</p>
<p>Lo otro es que cada diagonal tiene una cantidad de elementos que va en
aumento hasta llegar a la diagonal de la mitad (N-1) y después empieza a
disminuir, eso explica la variable top que recibe la función
run_diag(). También explica por que tenemos dos loops, y nos permite
eliminar los if.</p>
<p>Les queda propuesto deducir como llegué a los otros valores.</p>
<p>Un par de trucos que se usaron, para calcular el valor b (base), que
corresponde al indice inicial de cada diagonal (antidiagonal) se usa una
variable k que tiene dos valores posibles: 1 y n, por eso que se parte
con k = n y luego hace k = k/n en cada ciclo del for. La variable c es
el contador que va creciendo de 0 a (N*N-1), se pasa como parámetro y
se retorna como resultado, esto para usar un estilo más funcional, se
podría haber dejado como una variable global, o pasar por referencia.</p>
<p>Espero haber explicado bien la solución, sino para eso están los
comentarios.</p>
<p>Una cosa interesante es que a partir de esto es fácil generalizar para
el caso de una matriz de NxM (¿alguien se anima a hacer los cambios?).</p>
<p>A continuación el código completo:</p>
<pre><code>#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;

int run_diag(int* array, int base, int top, int d, int cont);

void zigzag(int* array, int n)
{
    int c = 0;
    int d = 1-n;
    int k = n;
    int n2 = 2*n;
    int z;

    for (z = 0; z &lt; n; z++, d = -d, k = n/k)
        c = run_diag(array, z*k, z+1, d, c);

    for (; z &lt; n2; z++, d = -d, k = n/k)
        c = run_diag(array, z*k+d*(z+1-n), n2-(z+1), d, c);
}

int run_diag(int* array, int base, int top, int delta, int cont)
{
    for (int i = 0, l = base; i &lt; top; i++, l += delta)
        array[l] = cont++;
    return cont;
}

void print_array(int* p, int n)
{
    for (int i = 0; i &lt; n; i++) {
        for (int j = 0; j &lt; n; j++)
            printf(&quot;%2d &quot;, *p++);
        printf(&quot;\n&quot;);
    }
}

int main(int argc, char* argv[])
{
    if (argc != 2) {
        fprintf(stderr, &quot;uso: zigzag N\n&quot;);
        return -1;
    }

    int n = atoi(argv[1]);
    int* array = (int*) malloc(n*n*sizeof(int));
    zigzag(array, n);
    print_array(array, n);
    return 0;
}
</code></pre>
<p>Gracias a todos los que han participado. Pronto publicaré otros
desafíos.</p>
</section></main>
        <footer id="main-footer"><div class="footer">
  <a href="#">Scroll to Top</a>
  <div class="footer-copyright">
    <div class="dim">© 2025 Eduardo Díaz</div>
    <div>Made with ❤️ and powered by <a href="https://github.com/math-queiroz/rusty-typewriter" target="_blank">Rusty Typewriter</a> theme for <a href="https://gohugo.io/" target="_blank">Hugo</a></div>
  </div>
</div>
</footer>
      </div><aside id="side-pane" class="side-sticky"><div class="side-details">
    <span>1081 words</span>
    <span>6 - 8 minutes read</span></div><h3>Attachments</h3>
    <ul><li><a href="http://localhost:1313/posts/2011/zig-zag/diagonales_zigzag.png">diagonales_zigzag.png</a></li><li><a href="http://localhost:1313/posts/2011/zig-zag/matriz6x6.png">matriz6x6.png</a></li><li><a href="http://localhost:1313/posts/2011/zig-zag/recorrido.png">recorrido.png</a></li><li><a href="http://localhost:1313/posts/2011/zig-zag/zigzag_arreglo.png">zigzag_arreglo.png</a></li></ul><h3>Related</h3>
    <ul><li><a href="/posts/2010/la-programaci%C3%B3n-en-10-anos-mas/">La programación en 10 años más</a></li><li><a href="/posts/2010/un-simple-test/">Un simple test</a></li><li><a href="/posts/2010/virtudes-y-defectos/">Virtudes y defectos</a></li><li><a href="/posts/2010/las-tres-grandes-virtudes-de-un-programador/">Las tres grandes virtudes de un programador </a></li><li><a href="/posts/2010/educaci%C3%B3n-libre/">Educación libre</a></li></ul></aside></div>
  </div>
</body>
</html>
