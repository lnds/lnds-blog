<!DOCTYPE html>
<html lang="es-cl" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Bugs Vergonzosos | La Naturaleza del Software</title>
<link rel="icon" href="/favicon.svg" sizes="any" type="image/svg+xml" /><meta property="og:url" content="http://localhost:1313/blog/lnds/2016/03/05/bugs-vergonzosos/">
  <meta property="og:site_name" content="La Naturaleza del Software">
  <meta property="og:title" content="Bugs Vergonzosos">
  <meta property="og:description" content="La palabra Bug, literalmente ‚Äúbicho‚Äù, usada para denotar un error inform√°tico, tiene su origen en el hallazgo de una polilla por parte de los operadores del Mark II, el hecho fue reportado por la famosa Grace Hopper.¬†La fotograf√≠a de abajo corresponde a una p√°gina de la bit√°cora de operaciones del Harvard Mark II. La nota de Hopper hace menci√≥n al ‚Äúprimer caso real de bicho encontrado‚Äù, denotando que el t√©rmino bug es mucho m√°s antiguo, el mismo Tomas Alva Edison usa la palabra bug para hablar de fallas mec√°nicas en sus inventos.">
  <meta property="og:locale" content="es_cl">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2016-03-05T08:25:11-03:00">
    <meta property="article:modified_time" content="2016-03-05T08:25:11-03:00">
    <meta property="article:tag" content="Errores">
    <meta property="article:tag" content="Calidad">
    <meta property="article:tag" content="Bugs">
    <meta property="og:image" content="http://localhost:1313/blog/lnds/2016/03/05/bugs-vergonzosos/featured.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/blog/lnds/2016/03/05/bugs-vergonzosos/featured.png">
  <meta name="twitter:title" content="Bugs Vergonzosos">
  <meta name="twitter:description" content="La palabra Bug, literalmente ‚Äúbicho‚Äù, usada para denotar un error inform√°tico, tiene su origen en el hallazgo de una polilla por parte de los operadores del Mark II, el hecho fue reportado por la famosa Grace Hopper.¬†La fotograf√≠a de abajo corresponde a una p√°gina de la bit√°cora de operaciones del Harvard Mark II. La nota de Hopper hace menci√≥n al ‚Äúprimer caso real de bicho encontrado‚Äù, denotando que el t√©rmino bug es mucho m√°s antiguo, el mismo Tomas Alva Edison usa la palabra bug para hablar de fallas mec√°nicas en sus inventos.">

    <link rel="stylesheet" href="/css/root.css">
    <link rel="stylesheet" href="/css/bundle.css">

      <script src="/js/bundle.js"></script><script defer src="/js/search/flexsearch.compact.64594b125f7b78bdf4fa8316955922bbebb1cd6baef3f16654bfca20309f18f8.js" integrity="sha256-ZFlLEl97eL30&#43;oMWlVkiu&#43;uxzWuu8/FmVL/KIDCfGPg="></script>
<script defer src="/js/search/search.1d980f84df11f3eb7c8c5f17f541d49a0611608df179dd74fa7f06225eb56ace.js" integrity="sha256-HZgPhN8R8&#43;t8jF8X9UHUmgYRYI3xed10&#43;n8GIl61as4="></script>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Spectral:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,200..800&family=Spectral:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel="stylesheet">

</head>
<body class="notransition">
  <div id="container">
    <header id="main-header"><div role="navigation" aria-label="Main">
  <div class="nav-left">
    <a href="http://localhost:1313/" style="color: inherit;">La Naturaleza del Software</a>
  </div>
  <div class="nav-right">
    <div style="position:absolute;width:0px;height:0px;">
      <div id="nav-dropdown-menu" class="hidden" href="#">
    <div class="nav-item">
      <a aria-current="true" class="ancestor" href="/posts/"
      >Posts</a>
    </div>
    <div class="nav-item">
      <a href="https://Newsletter.lnds.net"
      >Newsletter</a>
    </div>
    <div class="nav-item">
      <a href="/books/"
      >Books</a>
    </div>
    <div class="nav-item">
      <a href="/about/"
      >About</a>
    </div>
</div>
    </div>
    <a id="nav-dropdown-button" href="#"><svg width="20px" height="20px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M4 6H20M4 12H20M4 18H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</a>
    <div id="nav-menu">
    <div class="nav-item">
      <a aria-current="true" class="ancestor" href="/posts/"
      >Posts</a>
    </div>
    <div class="nav-item">
      <a href="https://Newsletter.lnds.net"
      >Newsletter</a>
    </div>
    <div class="nav-item">
      <a href="/books/"
      >Books</a>
    </div>
    <div class="nav-item">
      <a href="/about/"
      >About</a>
    </div>
</div>
    <a id="theme-switcher" href="#">
<svg class="light-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M12 3V4M12 20V21M4 12H3M6.31412 6.31412L5.5 5.5M17.6859 6.31412L18.5 5.5M6.31412 17.69L5.5 18.5001M17.6859 17.69L18.5 18.5001M21 12H20M16 12C16 14.2091 14.2091 16 12 16C9.79086 16 8 14.2091 8 12C8 9.79086 9.79086 8 12 8C14.2091 8 16 9.79086 16 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>

<svg class="dark-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M3.32031 11.6835C3.32031 16.6541 7.34975 20.6835 12.3203 20.6835C16.1075 20.6835 19.3483 18.3443 20.6768 15.032C19.6402 15.4486 18.5059 15.6834 17.3203 15.6834C12.3497 15.6834 8.32031 11.654 8.32031 6.68342C8.32031 5.50338 8.55165 4.36259 8.96453 3.32996C5.65605 4.66028 3.32031 7.89912 3.32031 11.6835Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</a>
  </div>
</div>
</header>
    <div class="flex grow">
      <div id="main-pane">
        <main id="main-content"><div class="single-header">
<ol class="breadcrumbs" itemscope itemtype="https://schema.org/BreadcrumbList">
    <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
      <a itemprop="item" href="http://localhost:1313/">
        <span itemprop="name">Home</span>
      </a>
      <meta itemprop="position" content='1' />
    </li>
    <span>&nbsp¬ª&nbsp</span>
    <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
      <a itemprop="item" href="http://localhost:1313/posts/">
        <span itemprop="name">Posts</span>
      </a>
      <meta itemprop="position" content='2' />
    </li>
    <span>&nbsp¬ª&nbsp</span>
</ol>
<h1>Bugs Vergonzosos</h1><time class="dim" datetime="2016-03-05T08:25:11-03:00">March 5, 2016</time><div class="term-container"><div class="tag">
        <a href="http://localhost:1313/tag/errores/">#errores</a>
      </div><div class="tag">
        <a href="http://localhost:1313/tag/calidad/">#calidad</a>
      </div><div class="tag">
        <a href="http://localhost:1313/tag/bugs/">#bugs</a>
      </div></ol></div>
  <section class="page-section"><p>La palabra Bug, literalmente &ldquo;bicho&rdquo;, usada para denotar un error
inform√°tico, tiene su origen en el hallazgo de una polilla por parte de
los operadores del Mark II, el hecho fue reportado por la famosa
<a href="//es.wikipedia.org/wiki/Grace_Murray_Hopper">Grace Hopper</a>.¬†</p>
<p>La fotograf√≠a de abajo corresponde a una p√°gina de la bit√°cora de
operaciones del Harvard Mark II. La nota de Hopper hace menci√≥n al
&ldquo;primer caso real de bicho encontrado&rdquo;, denotando que el t√©rmino bug
es mucho m√°s antiguo, el mismo Tomas Alva Edison usa la palabra bug para
hablar de fallas mec√°nicas en sus
inventos.</p>
<figure><img src="//d2dspjyoh5c79p.cloudfront.net/8c9220fc-e2d0-11e5-a13c-3371c0364c63-aa9f18b7"
    alt="El primer bug"><figcaption>
      <p>El primer bug</p>
    </figcaption>
</figure>

<p>En programaci√≥n nos encontramos con bugs todo el tiempo. Hay toda clase
de bugs, bugs que ocurren porque nos encontramos con una condici√≥n no
prevista, bugs por
un error en la implementaci√≥n del algoritmo, bugs originados por una
mala definici√≥n, o por asumir condiciones que no se dan,
etc.</p>
<p>Los bugs vergonzosos son aquellos debidos a la mala programaci√≥n.¬†</p>
<p>En 2014, para el 11¬∫ Simposio USENIX de Dise√±o e Implementaci√≥n de
Sistemas Operativos, un grupo de investigadores de la Universidad de
Toronto presentaron
<a href="//www.eecg.toronto.edu/~yuan/papers/failure_analysis_osdi14.pdf">el resultado de su investigaci√≥n</a>
sobre sistemas distribuidos en el mundo real.¬†</p>
<p>El Paper de este estudio se llama: &ldquo;Simple Testing Can Prevent Most
Critical Failures&rdquo; y lo pueden encontrar
<a href="//www.eecg.toronto.edu/~yuan/papers/failure_analysis_osdi14.pdf">ac√°</a>,
por si quieren profundizar en el tema.</p>
<p>Los investigadores eligieron los siguientes sistemas:¬†</p>
<blockquote>
<p>- <strong>Cassandra</strong>, la base de datos NoSQL desarrollada originalmente
por Facebook, mantenida por la Fundaci√≥n Apache, y que es usada entre
otros por Apple (con m√°s de 100.000 nodos) y NetFlix.</p>
<p>- <strong>HBase</strong>, otra importante base de datos NoSQL, usada por Spotify y
Facebook.</p>
<p>- <strong>Hadoop</strong>, en particular las componentes <strong>MapReduce</strong> y <strong>HDFS</strong>.</p>
<p>-<strong>Redis</strong>, el famoso ¬®servidor de estructuras de datos&quot;, usado en
multitud de servicios, como GitHub, Twitter, Pinterest o
StackOverflow.</p></blockquote>
<p>De los cinco sistemas analizados, cuatro est√°n escrito en Java y uno en
C. Estamos hablando de un estudio del software que es parte de la
infraestructura cr√≠tica de importantes y masivos servicios de
internet.</p>
<p>Estos sistemas son &ldquo;tolerantes a fallas&rdquo;, es decir, est√°n dise√±ados
para ser resilientes a errores en el entorno, sobrecarga de trabajo,
etc. Durante su trabajo, los investigadores lograron provocar un total
de 17,216 fallas al sistema, pero 48 fueron catastr√≥ficas, es decir,
lograron dejar inoperante el sistema. (En un caso la recuperaci√≥n
implic√≥ establecer sesiones SSH manuales a m√°s de 4.000 nodos para
detener los procesos).</p>
<p>Lo interesante del estudio es que descubrieron que muchos de los errores
catastr√≥ficos eran del estilo:s</p>
<pre><code>try {
¬† ¬† ....
} catch (Throwable t) {
¬† ¬†System.exit(-1);
}
</code></pre>
<p>O peor:</p>
<pre><code>try {
    ....
} catch (Throwable t) {
   // TODO
   LOG(&quot;se produjo un error...&quot;);
}
</code></pre>
<p>El 92% de los errores corresponden a un manejo incorrecto de errores,
pero que eran conocidos por los programadores, por estar expl√≠citamente
se√±alados en el c√≥digo.</p>
<p>El 35% son errores triviales: 25% causados por ignorar el error, 8% por
abortar durante la excepci√≥n, 2% simplemente tienen un comentario TODO
(<em>por hacer</em>, o <em>pendiente</em>, en ingl√©s) en el c√≥digo.</p>
<p>El 57% de los errores son espec√≠ficos del sistema, el 23% son
detectables f√°cilmente detectables y el 34% son complejos. La figura de
abajo, sacada del paper, resume la distribuci√≥n de los errores
catastr√≥ficos:</p>
<figure><img src="//d2dspjyoh5c79p.cloudfront.net/d6e105af-e2d9-11e5-a13c-3371c0364c63-aa9f18b7"
    alt="Divisi√≥n de errores"><figcaption>
      <p>Divisi√≥n de errores</p>
    </figcaption>
</figure>

<p>Quiero que reflexionemos sobre esto, estamos hablando de errores
triviales, que son manejados de manera descuidada.¬†</p>
<p>Tambi√©n estamos hablando de proyectos Opensource, y con esto tenemos
otro desmentido de esa falacia, convertida en mantra por algunos
fan√°ticos, llamada la Ley de Linus:</p>
<blockquote>
<p>¬´Dado un n√∫mero suficientemente elevado de ojos, todos los errores se
vuelven obvios.¬ª</p></blockquote>
<p>(La ley no fue formulada por Linus Torvalds, sino que por Eric Raymond
en su ensayo &ldquo;La Catedral y el Bazar&rdquo;).</p>
<p>De seguro en su trabajo y en el c√≥digo propio han visto cosas de este
estilo. Nuestros programas est√°n llenos de cosas similares, no tirar√© la
primera piedra, porque me confieso culpable, y muchas veces he dejado
&ldquo;esto para despu√©s&rdquo; y siempre me ha explotado en la cara. Traten de
evitarlo.¬†</p>
<p>Pero lo que no tiene perd√≥n, ni excusas a &ldquo;estas alturas del partido&rdquo;
es el Bug, o mejor dicho, la &ldquo;Verg√ºenza del Bisiesto&rdquo;.</p>
<p>El 29 de febrero de este a√±o, m√°s de 1.200 maletas no llegaron a sus
aviones por un error de a√±o bisiesto en el sistema de control de la
transportadora de equipajes del Aeropuerto de D√ºsseldorf.</p>
<p>Hay una lista de los errores de este a√±o en esta
direcci√≥n:¬†<a href="//codeofmatt.com/2016/02/29/list-of-2016-leap-day-bugs/">http://codeofmatt.com/2016/02/29/list-of-2016-leap-day-bugs/</a></p>
<p>Hay varios &ldquo;horrores&rdquo; documentados asociados a este bug:</p>
<p>- en 2012 el servicio de Cloud Computing Azure de Microsoft <a href="//azure.microsoft.com/en-us/blog/summary-of-windows-azure-service-disruption-on-feb-29th-2012/">estuvo con
problemas por 12 horas debido a un error al validar la expiraci√≥n de un
certificado el 29 de febrero de ese
a√±o</a>.</p>
<p>- en 2010 <a href="//www.nbcnews.com/id/35646131/ns/technology_and_science-games/t/leap-year-glitch-fixed-sony-playstation">la Play Station Network de Sony
fall√≥</a>
porque el sistema identific√≥ incorrectamente el a√±o 2010 como bisiesto
(!).</p>
<p>- en diciembre de 2008 <a href="//www.theguardian.com/technology/blog/2009/jan/01/zune-firmware-mistake">los dispositivos Zune de
Microsoft</a>¬†(que
pretend√≠an competir con los iPod) se congelaron.</p>
<p>El Bug del a√±o bisiesto se presenta de 2 formas, la m√°s conocida se da
en febrero, pero el 31 de diciembre tambi√©n ocurren problemas. Muchos
programa asumen que el √∫ltimo d√≠a del a√±o corresponde al d√≠a 365, cosa
que no se da en un a√±o bisiesto, que tiene 366 d√≠as.</p>
<p>[El error del Zune tiene que ver con este otro aspecto, este es el
infame c√≥digo que congel√≥ estos
dispositivos:]{style=&ldquo;letter-spacing: 0.01rem; line-height: 1.5;&rdquo;}</p>
<pre><code>01 year = ORIGINYEAR; /* = 1980 */
02 while (days &gt; 365) {
03  if (IsLeapYear(year)) {
04    if (days &gt; 366){
05      days -= 366;
06      year += 1;
07    }
08  }
09  else {
10    days -= 365;
11    year += 1;
12   }
13 }
</code></pre>
<p>El 31 de diciembre de 2008 la variable days ten√≠a el valor 366 y como
2008 es bisiesto, el programa entraba dentro de la condici√≥n de if de la
linea 03, pero ac√° no hay ninguna manera de alterar el valor de days,
que queda con el valor 366 para siempre, convirtiendo todo este c√≥digo
en un loop infinito.</p>
<p>Pero este problema se da tambi√©n en nuestro pa√≠s, este a√±o he escuchado
de 3 casos. De seguro ustedes conocen varios y ser√≠a interesante oir de
algunos en los comentarios.</p>
<p>¬øPor qu√© pasa esto?</p>
<p>Dice en la Biblia:</p>
<blockquote>
<p>&ldquo;Ens√©√±anos a contar bien nuestros d√≠as, para que nuestra mente
alcance sabidur√≠a.&rdquo; &ndash; Salmos 90:12</p></blockquote>
<p>Aunque no comparto la f√© del viejo Rey Salom√≥n, s√≠ estoy de acuerdo en
que es necesario que los programas aprendan a contar bien los d√≠as.¬†</p>
<p>Este salmo aparece citado como ep√≠grafe en uno de los art√≠culos m√°s
importantes que he le√≠do y que creo que deber√≠a leer todo aquel que
quiera llamarse a si mismo programador.
Se trata de &ldquo;CalendricalCalculations&rdquo;¬†un paper publicado en
Software Practice and Experience en septiembre de 1990.</p>
<p>Es un paper hermoso, con c√≥digo expresado en Lisp, lo que le da m√°s
estilo a√∫n üòú. Posteriormente los autores expandieron el art√≠culo en
forma de libro (<a href="//amzn.to/1VYgCUc">en Amazon</a>). En este art√≠culo
aparece todo lo que se debe saber sobre el manejo de fechas.</p>
<p>En Calendrical Calculation vemos esta pieza de c√≥digo, para determinar
el √∫ltimo d√≠a de un mes:</p>
<pre><code>(defun last-day-of-gegorian-month (month year)
¬† ¬†(if (and (= month 2)
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† (= (month year 4) 0)
¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† (not (member (mod year 400) (list 100 200 300))))
¬† ¬†29
¬† ¬†(nth (1- month) (list 31 28 31 30 31 30 31 31 30 31 30 31))))
</code></pre>
<p>Como no quiero provocarles urticaria, les voy a mostrar el c√≥digo en C:</p>
<pre><code>int last_day_of_gregorian_month(int year, int month) {
     int leap = (year%4 == 0 &amp;&amp; year%100 != 0) || year%400 == 0;
     int days[] = {31,28+leap,31,30,31,30,31,31,30,31,30,31};
     return days[month-1];
}
</code></pre>
<p>Un a√±o es bisiesto si es divisible por 4, pero se deben excluir las
centurias (divisibles por 100), con excepci√≥n de las centurias divisible
por 400. Es por esto que el a√±o 1.900 no fue bisiesto, pero s√≠ el 2.000.</p>
<p>De seguro el lenguaje que usas tiene funciones para poder calcular esto,
por ejemplo en Python:</p>
<pre><code>import calendar
calendar.monthrange(year, month)[1]
</code></pre>
<p>Lo importante es que verifiquen que las bibliotecas del lenguaje tengan
esto bien implementado.</p>
<p>As√≠ que esperemos que no tengamos que volver sobre este tema en cuatro
a√±os m√°s, porque significa que somos incapaces de aprender nada.¬†</p>
<p>S√≥lo piensen en el tiempo perdido, estr√©s, y dinero que sufrieron los
programadores, ingenieros de sistemas en cada uno de los casos que les
mencion√© antes.¬†</p>
</section></main>
        <footer id="main-footer"><div class="footer">
  <a href="#">Scroll to Top</a>
  <div class="footer-copyright">
    <div class="dim">¬© 2025 Eduardo D√≠az</div>
    <div>Made with ‚ù§Ô∏è and powered by <a href="https://github.com/math-queiroz/rusty-typewriter" target="_blank">Rusty Typewriter</a> theme for <a href="https://gohugo.io/" target="_blank">Hugo</a></div>
  </div>
</div>
</footer>
      </div><aside id="side-pane" class="side-sticky"><div class="side-details">
    <span>1387 words</span>
    <span>8 - 11 minutes read</span></div><h3>Attachments</h3>
    <ul><li><a href="http://localhost:1313/blog/lnds/2016/03/05/bugs-vergonzosos/featured.png">featured.png</a></li></ul><h3>Related</h3>
    <ul><li><a href="/blog/lnds/2015/01/18/historia-de-un-bug/">Historia de un Bug</a></li><li><a href="/blog/lnds/2014/11/22/dolores-de-cabeza/">Dolores de Cabeza</a></li><li><a href="/blog/lnds/2012/02/29/bisiesto/">¬°Bisiesto!</a></li><li><a href="/blog/lnds/2011/04/12/buggy-nights/">Buggy nights</a></li><li><a href="/blog/lnds/2010/08/10/control-de-calidad/">Control de Calidad</a></li></ul></aside></div>
  </div>
</body>
</html>
