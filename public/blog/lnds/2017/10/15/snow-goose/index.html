<!DOCTYPE html>
<html lang="es-cl" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Snow Goose | La Naturaleza del Software</title>
<link rel="icon" href="/favicon.svg" sizes="any" type="image/svg+xml" /><meta property="og:url" content="http://localhost:1313/blog/lnds/2017/10/15/snow-goose/">
  <meta property="og:site_name" content="La Naturaleza del Software">
  <meta property="og:title" content="Snow Goose">
  <meta property="og:description" content="Camel Camel es una gran banda de rock progresivo inglesa, fundada en 1971 por Andrew Latimer. Su formación original, aparte de Latimer en guitarra, contaría con Andy Ward, como baterista, Doug Ferguson en bajo y Peter Bardens en teclados. Fue en 1974, con su segundo álbum, Mirage, que fueron reconocidos por la crítica, y un moderado éxito que los llevó incluso de gira por el oeste de Estados Unidos de Norte América. Es un grupo que incorpora elementos de Jazz, música clásica y barroca, junto con toques electrónicos.">
  <meta property="og:locale" content="es_cl">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2017-10-15T08:25:11-03:00">
    <meta property="article:modified_time" content="2017-10-15T08:25:11-03:00">
    <meta property="article:tag" content="Desafios">
    <meta property="article:tag" content="Lenguajes Nuevos">
    <meta property="article:tag" content="Lenguajes">
    <meta property="article:tag" content="Lenguajes De Programación">
    <meta property="article:tag" content="Programación">
    <meta property="article:tag" content="Rock">
    <meta property="og:image" content="http://localhost:1313/blog/lnds/2017/10/15/snow-goose/featured.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/blog/lnds/2017/10/15/snow-goose/featured.png">
  <meta name="twitter:title" content="Snow Goose">
  <meta name="twitter:description" content="Camel Camel es una gran banda de rock progresivo inglesa, fundada en 1971 por Andrew Latimer. Su formación original, aparte de Latimer en guitarra, contaría con Andy Ward, como baterista, Doug Ferguson en bajo y Peter Bardens en teclados. Fue en 1974, con su segundo álbum, Mirage, que fueron reconocidos por la crítica, y un moderado éxito que los llevó incluso de gira por el oeste de Estados Unidos de Norte América. Es un grupo que incorpora elementos de Jazz, música clásica y barroca, junto con toques electrónicos.">

    <link rel="stylesheet" href="/css/root.css">
    <link rel="stylesheet" href="/css/bundle.css">

      <script src="/js/bundle.js"></script><script defer src="/js/search/flexsearch.compact.64594b125f7b78bdf4fa8316955922bbebb1cd6baef3f16654bfca20309f18f8.js" integrity="sha256-ZFlLEl97eL30&#43;oMWlVkiu&#43;uxzWuu8/FmVL/KIDCfGPg="></script>
<script defer src="/js/search/search.1d980f84df11f3eb7c8c5f17f541d49a0611608df179dd74fa7f06225eb56ace.js" integrity="sha256-HZgPhN8R8&#43;t8jF8X9UHUmgYRYI3xed10&#43;n8GIl61as4="></script>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Spectral:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,200..800&family=Spectral:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel="stylesheet">

</head>
<body class="notransition">
  <div id="container">
    <header id="main-header"><div role="navigation" aria-label="Main">
  <div class="nav-left">
    <a href="http://localhost:1313/" style="color: inherit;">La Naturaleza del Software</a>
  </div>
  <div class="nav-right">
    <div style="position:absolute;width:0px;height:0px;">
      <div id="nav-dropdown-menu" class="hidden" href="#">
    <div class="nav-item">
      <a aria-current="true" class="ancestor" href="/posts/"
      >Posts</a>
    </div>
    <div class="nav-item">
      <a href="https://Newsletter.lnds.net"
      >Newsletter</a>
    </div>
    <div class="nav-item">
      <a href="/books/"
      >Books</a>
    </div>
    <div class="nav-item">
      <a href="/about/"
      >About</a>
    </div>
</div>
    </div>
    <a id="nav-dropdown-button" href="#"><svg width="20px" height="20px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M4 6H20M4 12H20M4 18H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</a>
    <div id="nav-menu">
    <div class="nav-item">
      <a aria-current="true" class="ancestor" href="/posts/"
      >Posts</a>
    </div>
    <div class="nav-item">
      <a href="https://Newsletter.lnds.net"
      >Newsletter</a>
    </div>
    <div class="nav-item">
      <a href="/books/"
      >Books</a>
    </div>
    <div class="nav-item">
      <a href="/about/"
      >About</a>
    </div>
</div>
    <a id="theme-switcher" href="#">
<svg class="light-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M12 3V4M12 20V21M4 12H3M6.31412 6.31412L5.5 5.5M17.6859 6.31412L18.5 5.5M6.31412 17.69L5.5 18.5001M17.6859 17.69L18.5 18.5001M21 12H20M16 12C16 14.2091 14.2091 16 12 16C9.79086 16 8 14.2091 8 12C8 9.79086 9.79086 8 12 8C14.2091 8 16 9.79086 16 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>

<svg class="dark-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M3.32031 11.6835C3.32031 16.6541 7.34975 20.6835 12.3203 20.6835C16.1075 20.6835 19.3483 18.3443 20.6768 15.032C19.6402 15.4486 18.5059 15.6834 17.3203 15.6834C12.3497 15.6834 8.32031 11.654 8.32031 6.68342C8.32031 5.50338 8.55165 4.36259 8.96453 3.32996C5.65605 4.66028 3.32031 7.89912 3.32031 11.6835Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</a>
  </div>
</div>
</header>
    <div class="flex grow">
      <div id="main-pane">
        <main id="main-content"><div class="single-header">
<ol class="breadcrumbs" itemscope itemtype="https://schema.org/BreadcrumbList">
    <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
      <a itemprop="item" href="http://localhost:1313/">
        <span itemprop="name">Home</span>
      </a>
      <meta itemprop="position" content='1' />
    </li>
    <span>&nbsp»&nbsp</span>
    <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
      <a itemprop="item" href="http://localhost:1313/posts/">
        <span itemprop="name">Posts</span>
      </a>
      <meta itemprop="position" content='2' />
    </li>
    <span>&nbsp»&nbsp</span>
</ol>
<h1>Snow Goose</h1><time class="dim" datetime="2017-10-15T08:25:11-03:00">October 15, 2017</time><div class="term-container"><div class="tag">
        <a href="http://localhost:1313/tag/desafios/">#desafios</a>
      </div><div class="tag">
        <a href="http://localhost:1313/tag/lenguajes-nuevos/">#lenguajes nuevos</a>
      </div><div class="tag">
        <a href="http://localhost:1313/tag/lenguajes/">#lenguajes</a>
      </div><div class="tag">
        <a href="http://localhost:1313/tag/lenguajes-de-programaci%C3%B3n/">#lenguajes de programación</a>
      </div><div class="tag">
        <a href="http://localhost:1313/tag/programaci%C3%B3n/">#programación</a>
      </div><div class="tag">
        <a href="http://localhost:1313/tag/rock/">#rock</a>
      </div><div class="tag">
        <a href="http://localhost:1313/tag/fsharp/">#fsharp</a>
      </div><div class="tag">
        <a href="http://localhost:1313/tag/programaci%C3%B3n-funcional/">#programación funcional</a>
      </div></ol></div>
  <section class="page-section"><h2 id="camel">Camel</h2>
<p><a href="http://www.camelproductions.com/">Camel</a> es una gran banda de rock
progresivo inglesa, fundada en 1971 por <a href="https://en.wikipedia.org/wiki/Andrew_Latimer">Andrew
Latimer</a>. Su formación
original, aparte de Latimer en guitarra, contaría con <a href="https://en.wikipedia.org/wiki/Andy_Ward_(musician)">Andy
Ward</a>, como
baterista, Doug Ferguson en bajo y <a href="https://en.wikipedia.org/wiki/Peter_Bardens">Peter
Bardens</a> en teclados. Fue
en 1974, con su segundo álbum,
<a href="https://en.wikipedia.org/wiki/Mirage_(Camel_album)">Mirage</a>, que fueron
reconocidos por la crítica, y un moderado éxito que los llevó incluso de
gira por el oeste de Estados Unidos de Norte América. Es un grupo que
incorpora elementos de Jazz, música clásica y barroca, junto con toques
electrónicos.</p>
<figure><img src="https://d2dspjyoh5c79p.cloudfront.net/d6892676-b1c7-11e7-a030-2b5831f8ecb5-aa9f18b7"
    alt="Portada del álbum Mirage de Camel"><figcaption>
      <p>Portada del álbum Mirage de Camel</p>
    </figcaption>
</figure>

<p>Quizás una de sus obras más importantes es
<a href="https://en.wikipedia.org/wiki/The_Snow_Goose_(album)">&ldquo;The Snow Goose&rdquo;</a>, un álbum
conceptual, inspirado en la novela homónima de
<a href="https://en.wikipedia.org/wiki/Paul_Gallico">Paul Gallico</a> (quién también
escribió &ldquo;La Aventura del Poseidón&rdquo; que fue llevada posteriormente al
cine). Se trata de una hermosa pieza instrumental que habla sobre la
amistad con el telón de fondo de la guerra, durante la terrible
<a href="https://es.wikipedia.org/wiki/Operaci%C3%B3n_Dinamo">Evacuación de Dunkerke</a>, en la
Segunda Guerra Mundial.</p>
<p>De ahí Camel fue creciendo en fama, llegando a la cima comercial con
&ldquo;I Can See Your House from Here&rdquo;, de 1979, un álbum que fue polémico por
su portada, la que muestra a un astronauta crucificado flotando sobre la
tierra.</p>
<figure><img src="https://d2dspjyoh5c79p.cloudfront.net/0b09b3b7-b1c8-11e7-a030-2b5831f8ecb5-aa9f18b7"
    alt="Portada de &ldquo;I Can See Your House From Here&rdquo;"><figcaption>
      <p>Portada de &ldquo;I Can See Your House From Here&rdquo;</p>
    </figcaption>
</figure>

<p>Pero los ochenta no fueron buenos para Camel, después de grabar
<a href="https://en.wikipedia.org/wiki/Nude_(Camel_album)">Nude</a>, otro álbum
conceptual inspirado en la historia del soldado japonés <a href="https://en.wikipedia.org/wiki/Hiroo_Onoda">Hiroo
Onoda</a> (quien fue encontrado,
varios años después de terminada la Segunda Guerra Mundial, aún
escondido en una isla, pues no se había enterado de que ésta había
acabado), la banda se encontraba en crisis. </p>
<p>El baterista Andy Ward decidió abandonar la banda para rehabilitarse del
alcoholismo y las drogas (años después Ward pasó a integrar Marillion).
Bardens y Ferguson habían dejado la banda entre 1977 y 1978 y habían
sido reemplazado por otros músicos (quienes venían principalmente de
<a href="https://en.wikipedia.org/wiki/Caravan_(band)">Caravan</a> otra famosa
banda de la <a href="https://en.wikipedia.org/wiki/Canterbury_scene">Escena de
Canterbury</a>).</p>
<p><img src="https://d2dspjyoh5c79p.cloudfront.net/36865ca8-b1c8-11e7-a030-2b5831f8ecb5-aa9f18b7" alt="Nude"></p>
<p>Fue así como en 1982 Latimer se encontraba cómo el único miembro
fundador del grupo. Pero su casa discográfica le exigía el cumplimiento
del contrato y esto implicaba tener al menos un &lsquo;&ldquo;hit&rsquo;&rdquo;. La historia del
rock está llena de estas situaciones, en que los artistas graban
obligados alguna pieza. En ese entonces Latimer ya había trabajado con
su mujer Susan Hoover, en las líricas. </p>
<p>Obligado Latimer se dirigió a los estudios Abbey Road y contrató a
varios músicos de sesión, entre los que se encontraban el bajista <a href="https://en.wikipedia.org/wiki/David_Paton">David
Paton</a> y el cantante <a href="https://en.wikipedia.org/wiki/Chris_Rainbow">Chris
Rainbow</a>, quienes ya habían
trabajado en <a href="https://en.wikipedia.org/wiki/The_Alan_Parsons_Project">Alan Parsons
Project</a>. El
resultado de esta obligación contractual es un álbum de despedida de
Camel, titulado <a href="https://en.wikipedia.org/wiki/The_Single_Factor">&rsquo;&ldquo;The Single
Factor&rsquo;&rdquo;</a>, un álbum
regular después de todo lo logrado por la banda. Una pieza muy inclinada
al pop, con algunas canciones pensadas para agradar al público masivo, y
con bastante influencia de Alan Parsons Project.</p>
<figure><img src="https://d2dspjyoh5c79p.cloudfront.net/49f97519-b1c8-11e7-a030-2b5831f8ecb5-aa9f18b7"
    alt="The Single Factor"><figcaption>
      <p>The Single Factor</p>
    </figcaption>
</figure>

<p>Así empezó el gran hiato de Camel, hasta que Latimer revive a la banda
en 1991, con una nueva encarnación y grabando en USA, a donde se muda
después de vender su casa en Inglaterra. El álbum se llama &lsquo;&ldquo;Dust and
Dreams&rsquo;&rdquo;, y está inspirado en la novela &lsquo;&ldquo;Las uvas de la Ira&rsquo;&rdquo;, de
Steinbeck. Desde entonces Latimer ha seguido activo y sigue siendo
venerado dentro del rock progresivo.</p>
<p>Es quizás una de las grandes bandas de las que nunca has escuchado, y ha
tenido gran influencia en lo que fue el <a href="https://en.wikipedia.org/wiki/Neo-progressive_rock">Neo Progresivo</a> y ha sido citado como inspiración por Opeth, Steven Wilson y Dream Theater, entre otros.</p>
<p><strong>OCaml</strong></p>
<p>Caml es un lenguaje de programación creado en Francia por el
<a href="https://www.inria.fr/en/">INRIA</a> (<em>Institut national de recherche en
informatique et en automatique</em>[). Se trata de un lenguaje
multiparadigma, descendiente de ML. Caml viene de Categorical Abstract
Machine Language.</p>
<p>En 1991 el mismo INRIA amplió el lenguaje, agregando una capa orientada
al objeto creando <a href="http://ocaml.org/">OCaml</a>, Objective
Caml.</p>
<p>OCaml es un hito muy importante en el desarrollo de los lenguajes de
programación, siendo el inspirador tanto de Scala como de F# y con una
fuerte influencia en Rust.</p>
<figure><img src="https://d2dspjyoh5c79p.cloudfront.net/910b464b-b1c8-11e7-a030-2b5831f8ecb5-aa9f18b7"
    alt="Logo de OCaml"><figcaption>
      <p>Logo de OCaml</p>
    </figcaption>
</figure>

<p>OCaml tiene un sistema de tipos estático, con inferencia de tipos,
polimorfismo paramétrico, administración automática de la memoria, tail
recursion, pattern matching, functores, y varias de las características
que vemos en los lenguajes más modernos.</p>
<p>Veamos un ejemplo de OCaml</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-ocaml" data-lang="ocaml"><span style="display:flex;"><span>     <span style="color:#66d9ef">let</span> <span style="color:#66d9ef">rec</span> qsort <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span>
</span></span><span style="display:flex;"><span>       <span style="color:#f92672">|</span> [] <span style="color:#f92672">-&gt;</span> []
</span></span><span style="display:flex;"><span>       <span style="color:#f92672">|</span> pivot <span style="color:#f92672">::</span> rest <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>           <span style="color:#66d9ef">let</span> is_less x <span style="color:#f92672">=</span> x <span style="color:#f92672">&lt;</span> pivot <span style="color:#66d9ef">in</span>
</span></span><span style="display:flex;"><span>           <span style="color:#66d9ef">let</span> left<span style="color:#f92672">,</span> right <span style="color:#f92672">=</span> List.partition is_less rest <span style="color:#66d9ef">in</span>
</span></span><span style="display:flex;"><span>           qsort left <span style="color:#f92672">@</span> <span style="color:#f92672">[</span>pivot<span style="color:#f92672">]</span> <span style="color:#f92672">@</span> qsort right
</span></span></code></pre></div><p>Este es el clásico algoritmo qsort en OCaml. En F# se escribiría así:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span>     <span style="color:#66d9ef">let</span> rec qsort <span style="color:#66d9ef">list</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">match</span> <span style="color:#66d9ef">list</span> <span style="color:#66d9ef">with</span> 
</span></span><span style="display:flex;"><span>       <span style="color:#f92672">|</span> [] <span style="color:#f92672">-&gt;</span> []
</span></span><span style="display:flex;"><span>       <span style="color:#f92672">|</span> pivot <span style="color:#f92672">::</span> rest <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>           <span style="color:#66d9ef">let</span> is_less x <span style="color:#f92672">=</span> x <span style="color:#f92672">&lt;</span> pivot <span style="color:#66d9ef">in</span>
</span></span><span style="display:flex;"><span>           <span style="color:#66d9ef">let</span> left<span style="color:#f92672">,</span> right <span style="color:#f92672">=</span> List.partition is_less rest <span style="color:#66d9ef">in</span>
</span></span><span style="display:flex;"><span>           qsort left <span style="color:#f92672">@</span> <span style="color:#f92672">[</span>pivot<span style="color:#f92672">]</span> <span style="color:#f92672">@</span> qsort right
</span></span></code></pre></div><p>Como se puede apreciar son bastante parecidos. En mi opinión OCaml es
mucho mejor que F#. En mi ignorancia pensé que OCaml era un lenguaje
extinto (del mismo modo que pensaba que Camel era una banda que ya no
estaba activa). </p>
<p>F# es un lenguaje muy interesante, creado por Microsoft Research Labs
en Cambridge Inglaterra. Quizás las innovaciones más interesantes de F#
sean las unidades de medida, la meta programación (que nos permite crear
lenguajes de dominio específico) y el concepto de information rich
programming.</p>
<p>Veamos un ejemplo, primero con las unidades de medida:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span>    <span style="color:#f92672">[&lt;</span>Measure<span style="color:#f92672">&gt;]</span> <span style="color:#66d9ef">type</span> <span style="color:#a6e22e">kg</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">[&lt;</span>Measure<span style="color:#f92672">&gt;]</span> <span style="color:#66d9ef">type</span> <span style="color:#a6e22e">s</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">[&lt;</span>Measure<span style="color:#f92672">&gt;]</span> <span style="color:#66d9ef">type</span> <span style="color:#a6e22e">m</span>
</span></span></code></pre></div><p>Con esto hemos definido el sistema de medidas
<a href="https://es.wikipedia.org/wiki/Sistema_MKS_de_unidades">MKS</a>.</p>
<p>Así que podemos escribir cosas como las siguientes:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> gravedadTerrestre <span style="color:#f92672">=</span> 9<span style="color:#f92672">.</span>8<span style="color:#f92672">&lt;</span>m<span style="color:#f92672">/</span>s<span style="color:#f92672">^</span>2<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> alturaDeMiOficina <span style="color:#f92672">=</span> 32<span style="color:#f92672">.</span>5<span style="color:#f92672">&lt;</span>m<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> velocidadDeImpacto <span style="color:#f92672">=</span> sqrt <span style="color:#f92672">(</span>2<span style="color:#f92672">.</span>0 <span style="color:#f92672">*</span> gravedadTerrestre <span style="color:#f92672">*</span> alturaDeMiOficina<span style="color:#f92672">)</span>
</span></span></code></pre></div><p>Con esto velocidadDeImpacto se expresa como <code>float&lt;m/s&gt;</code></p>
<p>Si cometo la equivocación de escribir esto:</p>
<pre><code>let velocidadDeImpacto = sqrt (2.0 * gravedadTerrestre + alturaDeMiOficina)
</code></pre>
<p>Obtendré un error indicando que la unidad de medida m no calza con
m/s^2.</p>
<p>Lo interesante es que podemos derivar unidades, por ejemplo, el Newton:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span>    <span style="color:#f92672">[&lt;</span>Measure<span style="color:#f92672">&gt;]</span> <span style="color:#66d9ef">type</span> <span style="color:#a6e22e">N</span> <span style="color:#f92672">=</span> kg m<span style="color:#f92672">/</span>s<span style="color:#f92672">^</span>2
</span></span></code></pre></div><p>y podemos hacer:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> masa <span style="color:#f92672">=</span> 70<span style="color:#f92672">.</span>0<span style="color:#f92672">&lt;</span>kg<span style="color:#f92672">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> fuerza<span style="color:#f92672">:</span><span style="color:#66d9ef">float</span><span style="color:#f92672">&lt;</span>N<span style="color:#f92672">&gt;</span> <span style="color:#f92672">=</span> masa<span style="color:#f92672">*</span>gravedadTerrestre
</span></span></code></pre></div><h2 id="huffman-en-f">Huffman en F#</h2>
<p>La solución en F# para nuestro cuarto desafío, en esta serie sobre esos
&lsquo;&ldquo;raros lenguajes nuevos&rsquo;&rdquo;, es de las más breves, superada sólo por la
solución en Clojure.</p>
<p>Veamos lo más relevante de la solución.</p>
<p>Para modelar el árbol de Huffman usamos un tipo algebraico:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span>    <span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Tree</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">|</span> Leaf <span style="color:#66d9ef">of</span> <span style="color:#66d9ef">byte</span> <span style="color:#f92672">*</span> int
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">|</span> Node <span style="color:#66d9ef">of</span> Tree <span style="color:#f92672">*</span> Tree  <span style="color:#f92672">*</span> int
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">member</span> this.<span style="color:#a6e22e">Freq</span>() <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">match</span> this <span style="color:#66d9ef">with</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">|</span> Leaf<span style="color:#f92672">(_,</span> f<span style="color:#f92672">)</span> <span style="color:#f92672">-&gt;</span> f
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">|</span> Node<span style="color:#f92672">(_,_,</span>f<span style="color:#f92672">)</span> <span style="color:#f92672">-&gt;</span> f
</span></span><span style="display:flex;"><span>            
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">member</span> this.<span style="color:#a6e22e">WriteTo</span><span style="color:#f92672">(</span>writer<span style="color:#f92672">:</span>BitOutputStream<span style="color:#f92672">)</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">match</span> this <span style="color:#66d9ef">with</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">|</span> Leaf<span style="color:#f92672">(</span>s<span style="color:#f92672">,</span> <span style="color:#f92672">_)</span> <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>                writer<span style="color:#f92672">.</span>WriteBit<span style="color:#f92672">(</span><span style="color:#66d9ef">true</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>                writer<span style="color:#f92672">.</span>WriteByte<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">|</span> Node<span style="color:#f92672">(</span>l<span style="color:#f92672">,</span> r<span style="color:#f92672">,</span> <span style="color:#f92672">_)</span> <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>                writer<span style="color:#f92672">.</span>WriteBit<span style="color:#f92672">(</span><span style="color:#66d9ef">false</span><span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>                l<span style="color:#f92672">.</span>WriteTo<span style="color:#f92672">(</span>writer<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>                r<span style="color:#f92672">.</span>WriteTo<span style="color:#f92672">(</span>writer<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>                
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">member</span> this.<span style="color:#a6e22e">ReadChar</span><span style="color:#f92672">(</span>reader<span style="color:#f92672">:</span>BitInputStream<span style="color:#f92672">)</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">match</span> this <span style="color:#66d9ef">with</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">|</span> Leaf<span style="color:#f92672">(</span>s<span style="color:#f92672">,</span> <span style="color:#f92672">_)</span> <span style="color:#f92672">-&gt;</span> s
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">|</span> Node<span style="color:#f92672">(</span>left<span style="color:#f92672">,</span> right<span style="color:#f92672">,</span> <span style="color:#f92672">_)</span> <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> reader<span style="color:#f92672">.</span>ReadBit() <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>                    right<span style="color:#f92672">.</span>ReadChar<span style="color:#f92672">(</span>reader<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>                    left<span style="color:#f92672">.</span>ReadChar<span style="color:#f92672">(</span>reader<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>               
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">member</span> this.<span style="color:#a6e22e">Parse</span><span style="color:#f92672">(</span>reader<span style="color:#f92672">:</span>BitInputStream<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>writer<span style="color:#f92672">:</span>Stream<span style="color:#f92672">)</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">while</span> <span style="color:#f92672">not</span> reader<span style="color:#f92672">.</span>Eof <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">let</span> ch <span style="color:#f92672">=</span> this<span style="color:#f92672">.</span>ReadChar<span style="color:#f92672">(</span>reader<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>                writer<span style="color:#f92672">.</span>WriteByte<span style="color:#f92672">(</span>ch<span style="color:#f92672">)</span>
</span></span></code></pre></div><p>Con esto decimos que un Arbol (Tree) puede ser una Hoja (Leaf) que
corresponde a una tupla de un byte y un entero. Por otro lado, un Nodo
(Node) tiene dos árboles y un entero.</p>
<p>La sentencia member nos permite definir &lsquo;&ldquo;métodos&rsquo;&rdquo; para este tipo. Los
que usamos posteriormente para persistir el árbol en disco, o para
descomprimir (en el método Parser).</p>
<p>La compresión se resuelve con esta función:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> compress <span style="color:#f92672">(</span>input<span style="color:#f92672">:</span><span style="color:#66d9ef">string</span><span style="color:#f92672">)</span> <span style="color:#f92672">(</span>output<span style="color:#f92672">:</span><span style="color:#66d9ef">string</span><span style="color:#f92672">)</span> <span style="color:#f92672">=</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">let</span> bs <span style="color:#f92672">=</span> File.ReadAllBytes input
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">let</span> tree <span style="color:#f92672">=</span>  List.ofArray bs <span style="color:#f92672">|&gt;</span> calcFreqs <span style="color:#f92672">|&gt;</span> buildTree
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">let</span> codes <span style="color:#f92672">=</span> makeCodes tree
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">use</span> writer <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> BitOutputStream<span style="color:#f92672">(</span>output<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        tree<span style="color:#f92672">.</span>WriteTo<span style="color:#f92672">(</span>writer<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">for</span> b <span style="color:#66d9ef">in</span> bs <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>            writer<span style="color:#f92672">.</span>WriteBits<span style="color:#f92672">(</span>codes<span style="color:#f92672">.[</span>b<span style="color:#f92672">])</span>
</span></span></code></pre></div><p>Noten esta sentencia:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> tree <span style="color:#f92672">=</span>  List.ofArray bs <span style="color:#f92672">|&gt;</span> calcFreqs <span style="color:#f92672">|&gt;</span> buildTree
</span></span></code></pre></div><p>Esto es un pipeline, que permite componer una serie de funciones.</p>
<p>La función buildTree es recursiva y es similar a la que usamos en
<a href="/blog/lnds/2017/07/17/close-to-the-edge-down-to-the-river">nuestra solución en
Scala</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> buildTree <span style="color:#f92672">(</span>freqs<span style="color:#f92672">:</span> <span style="color:#f92672">(</span><span style="color:#66d9ef">byte</span><span style="color:#f92672">*</span>int<span style="color:#f92672">)</span> <span style="color:#66d9ef">list</span><span style="color:#f92672">)</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">let</span> sort <span style="color:#f92672">(</span>tree<span style="color:#f92672">:</span> Tree <span style="color:#66d9ef">list</span><span style="color:#f92672">)</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>            tree <span style="color:#f92672">|&gt;</span> List.sortBy<span style="color:#f92672">(</span><span style="color:#66d9ef">fun</span> i <span style="color:#f92672">-&gt;</span> i<span style="color:#f92672">.</span>Freq()<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">let</span> rec loop <span style="color:#f92672">(</span>tree<span style="color:#f92672">:</span> Tree <span style="color:#66d9ef">list</span><span style="color:#f92672">)</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">match</span> sort tree <span style="color:#66d9ef">with</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">|</span> left<span style="color:#f92672">::</span>right<span style="color:#f92672">::</span>[] <span style="color:#f92672">-&gt;</span> Node<span style="color:#f92672">(</span>left<span style="color:#f92672">,</span> right<span style="color:#f92672">,</span> left<span style="color:#f92672">.</span>Freq() <span style="color:#f92672">+</span> right<span style="color:#f92672">.</span>Freq()<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">|</span> left<span style="color:#f92672">::</span>right<span style="color:#f92672">::</span>tail <span style="color:#f92672">-&gt;</span> 
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">let</span> node <span style="color:#f92672">=</span> Node<span style="color:#f92672">(</span>left<span style="color:#f92672">,</span>  right<span style="color:#f92672">,</span> left<span style="color:#f92672">.</span>Freq() <span style="color:#f92672">+</span> right<span style="color:#f92672">.</span>Freq()<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>                loop <span style="color:#f92672">(</span>node <span style="color:#f92672">::</span> tail<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">|</span> <span style="color:#f92672">[</span>node<span style="color:#f92672">]</span> <span style="color:#f92672">-&gt;</span> node
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">|</span> [] <span style="color:#f92672">-&gt;</span> failwith <span style="color:#e6db74">&#34;empty tree list!&#34;</span>
</span></span><span style="display:flex;"><span>        freqs <span style="color:#f92672">|&gt;</span> Seq.map Leaf <span style="color:#f92672">|&gt;</span> List.ofSeq <span style="color:#f92672">|&gt;</span> loop 
</span></span></code></pre></div><p>Por último, para descomprimir hacemos:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> decompress <span style="color:#f92672">(</span>input<span style="color:#f92672">:</span><span style="color:#66d9ef">string</span><span style="color:#f92672">)</span> <span style="color:#f92672">(</span>output<span style="color:#f92672">:</span><span style="color:#66d9ef">string</span><span style="color:#f92672">)</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">use</span> reader <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> BitInputStream<span style="color:#f92672">(</span>input<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">let</span> tree <span style="color:#f92672">=</span> readTree<span style="color:#f92672">(</span>reader<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">let</span> writer <span style="color:#f92672">=</span> File.OpenWrite<span style="color:#f92672">(</span>output<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        tree<span style="color:#f92672">.</span>Parse reader writer
</span></span></code></pre></div><p>La función readTree es interesante, porque en F# las funciones deben
estar bien definidas antes de ser usadas, pero readTree usa dos
funciones mutuamente recursivas, así que usamos la notación <strong>let and</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fsharp" data-lang="fsharp"><span style="display:flex;"><span>    <span style="color:#66d9ef">let</span> rec readTree <span style="color:#f92672">(</span>reader<span style="color:#f92672">:</span>BitInputStream<span style="color:#f92672">)</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">let</span> b <span style="color:#f92672">=</span> reader<span style="color:#f92672">.</span>ReadBit()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> b <span style="color:#66d9ef">then</span> 
</span></span><span style="display:flex;"><span>            readLeaf<span style="color:#f92672">(</span>reader<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>            readNode<span style="color:#f92672">(</span>reader<span style="color:#f92672">)</span><span style="color:#f92672">and</span> readLeaf<span style="color:#f92672">(</span>reader<span style="color:#f92672">:</span>BitInputStream<span style="color:#f92672">)</span> <span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>           <span style="color:#66d9ef">let</span> sym <span style="color:#f92672">=</span> reader<span style="color:#f92672">.</span>ReadByte()
</span></span><span style="display:flex;"><span>           Leaf<span style="color:#f92672">(</span>sym<span style="color:#f92672">,</span> <span style="color:#f92672">-</span>1<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>                       
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">and</span> readNode<span style="color:#f92672">(</span>reader<span style="color:#f92672">:</span>BitInputStream<span style="color:#f92672">)</span> <span style="color:#f92672">=</span> 
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">let</span> left <span style="color:#f92672">=</span> readTree<span style="color:#f92672">(</span>reader<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">let</span> right <span style="color:#f92672">=</span> readTree<span style="color:#f92672">(</span>reader<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>                Node<span style="color:#f92672">(</span>left<span style="color:#f92672">,</span> right<span style="color:#f92672">,</span> <span style="color:#f92672">-</span>1<span style="color:#f92672">)</span>
</span></span></code></pre></div><p>El resto del código lo pueden ver en mi repositorio en
Github: <a href="https://github.com/lnds/9d9l/tree/master/desafio4/fsharp">https://github.com/lnds/9d9l/tree/master/desafio4/fsharp</a></p>
<p>Y para finalizar, los dejo con Camel en Vivo, dos videos, uno de 1975
donde la formación original interpreta fragmentos de Snow Goose
acompañado de una orquesta de cámara:</p>
<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/nrjvkcEQ8vw?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"></iframe>
    </div>

<p>Y el segundo video es de 1997, corresponde a Coming of Age:</p>
<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
      <iframe allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen" loading="eager" referrerpolicy="strict-origin-when-cross-origin" src="https://www.youtube.com/embed/uSYV8mVllQo?autoplay=0&amp;controls=1&amp;end=0&amp;loop=0&amp;mute=0&amp;start=0" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" title="YouTube video"></iframe>
    </div>

</section></main>
        <footer id="main-footer"><div class="footer">
  <a href="#">Scroll to Top</a>
  <div class="footer-copyright">
    <div class="dim">© 2025 Eduardo Díaz</div>
    <div>Made with ❤️ and powered by <a href="https://github.com/math-queiroz/rusty-typewriter" target="_blank">Rusty Typewriter</a> theme for <a href="https://gohugo.io/" target="_blank">Hugo</a></div>
  </div>
</div>
</footer>
      </div><aside id="side-pane" class="side-sticky"><div class="side-details">
    <span>1507 words</span>
    <span>11 - 14 minutes read</span></div><h3>Table Of Contents</h3><nav id="TableOfContents">
  <ul>
    <li><a href="#camel">Camel</a></li>
    <li><a href="#huffman-en-f">Huffman en F#</a></li>
  </ul>
</nav><h3>Attachments</h3>
    <ul><li><a href="http://localhost:1313/blog/lnds/2017/10/15/snow-goose/featured.png">featured.png</a></li></ul><h3>Related</h3>
    <ul><li><a href="/blog/lnds/2017/09/24/red-barcheta/">Red Barchetta</a></li><li><a href="/blog/lnds/2017/08/29/occams-razor/">Occam&#39;s Razor</a></li><li><a href="/blog/lnds/2017/07/17/close-to-the-edge-down-to-the-river/">Close to the Edge, down by the river</a></li><li><a href="/blog/lnds/2017/06/10/pour-some-syntactic-sugar-on-me/">Pour Some Syntactic Sugar on Me</a></li><li><a href="/blog/lnds/2016/06/21/como-obtener-el-reporte-del-clima/">Cómo obtener el reporte del clima</a></li></ul></aside></div>
  </div>
</body>
</html>
