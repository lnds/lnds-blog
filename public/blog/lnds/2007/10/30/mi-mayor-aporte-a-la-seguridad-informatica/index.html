<!DOCTYPE html>
<html lang="es-cl" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Mi mayor aporte a la seguridad informática | La Naturaleza del Software</title>
<link rel="icon" href="/favicon.svg" sizes="any" type="image/svg+xml" /><meta property="og:url" content="http://localhost:1313/blog/lnds/2007/10/30/mi-mayor-aporte-a-la-seguridad-informatica/">
  <meta property="og:site_name" content="La Naturaleza del Software">
  <meta property="og:title" content="Mi mayor aporte a la seguridad informática">
  <meta property="og:description" content="Escribo este artículo con orgullo y preocupación. Orgullo por el impacto que logró mi trabajo y preocupación porque, bueno ya van a ver porque.
El año 2005 escribí un artículo en codeproject donde mostré un esquema práctico que explotaba una de las vulnerabilidades encontradas en ese tiempo al algoritmo MD5. El artículo alcanzó notoriedad al ser destacado en Slashdot, y en Kriptópolis.
Mi artículo original está en inglés y hay un (muy breve) resumen en este mismo blog.">
  <meta property="og:locale" content="es_cl">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2007-10-30T08:25:11-03:00">
    <meta property="article:modified_time" content="2007-10-30T08:25:11-03:00">
    <meta property="article:tag" content="Seguridad">
    <meta property="article:tag" content="Md5">
    <meta property="article:tag" content="Criptografía">
    <meta property="article:tag" content="Vulnerabilidades">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Mi mayor aporte a la seguridad informática">
  <meta name="twitter:description" content="Escribo este artículo con orgullo y preocupación. Orgullo por el impacto que logró mi trabajo y preocupación porque, bueno ya van a ver porque.
El año 2005 escribí un artículo en codeproject donde mostré un esquema práctico que explotaba una de las vulnerabilidades encontradas en ese tiempo al algoritmo MD5. El artículo alcanzó notoriedad al ser destacado en Slashdot, y en Kriptópolis.
Mi artículo original está en inglés y hay un (muy breve) resumen en este mismo blog.">

    <link rel="stylesheet" href="/css/root.css">
    <link rel="stylesheet" href="/css/bundle.css">

      <script src="/js/bundle.js"></script><script defer src="/js/search/flexsearch.compact.64594b125f7b78bdf4fa8316955922bbebb1cd6baef3f16654bfca20309f18f8.js" integrity="sha256-ZFlLEl97eL30&#43;oMWlVkiu&#43;uxzWuu8/FmVL/KIDCfGPg="></script>
<script defer src="/js/search/search.1d980f84df11f3eb7c8c5f17f541d49a0611608df179dd74fa7f06225eb56ace.js" integrity="sha256-HZgPhN8R8&#43;t8jF8X9UHUmgYRYI3xed10&#43;n8GIl61as4="></script>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Spectral:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,200..800&family=Spectral:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel="stylesheet">

</head>
<body class="notransition">
  <div id="container">
    <header id="main-header"><div role="navigation" aria-label="Main">
  <div class="nav-left">
    <a href="http://localhost:1313/" style="color: inherit;">La Naturaleza del Software</a>
  </div>
  <div class="nav-right">
    <div style="position:absolute;width:0px;height:0px;">
      <div id="nav-dropdown-menu" class="hidden" href="#">
    <div class="nav-item">
      <a aria-current="true" class="ancestor" href="/posts/"
      >Posts</a>
    </div>
    <div class="nav-item">
      <a href="https://Newsletter.lnds.net"
      >Newsletter</a>
    </div>
    <div class="nav-item">
      <a href="/books/"
      >Books</a>
    </div>
    <div class="nav-item">
      <a href="/about/"
      >About</a>
    </div>
</div>
    </div>
    <a id="nav-dropdown-button" href="#"><svg width="20px" height="20px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M4 6H20M4 12H20M4 18H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</a>
    <div id="nav-menu">
    <div class="nav-item">
      <a aria-current="true" class="ancestor" href="/posts/"
      >Posts</a>
    </div>
    <div class="nav-item">
      <a href="https://Newsletter.lnds.net"
      >Newsletter</a>
    </div>
    <div class="nav-item">
      <a href="/books/"
      >Books</a>
    </div>
    <div class="nav-item">
      <a href="/about/"
      >About</a>
    </div>
</div>
    <a id="theme-switcher" href="#">
<svg class="light-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M12 3V4M12 20V21M4 12H3M6.31412 6.31412L5.5 5.5M17.6859 6.31412L18.5 5.5M6.31412 17.69L5.5 18.5001M17.6859 17.69L18.5 18.5001M21 12H20M16 12C16 14.2091 14.2091 16 12 16C9.79086 16 8 14.2091 8 12C8 9.79086 9.79086 8 12 8C14.2091 8 16 9.79086 16 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>

<svg class="dark-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M3.32031 11.6835C3.32031 16.6541 7.34975 20.6835 12.3203 20.6835C16.1075 20.6835 19.3483 18.3443 20.6768 15.032C19.6402 15.4486 18.5059 15.6834 17.3203 15.6834C12.3497 15.6834 8.32031 11.654 8.32031 6.68342C8.32031 5.50338 8.55165 4.36259 8.96453 3.32996C5.65605 4.66028 3.32031 7.89912 3.32031 11.6835Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</a>
  </div>
</div>
</header>
    <div class="flex grow">
      <div id="main-pane">
        <main id="main-content"><div class="single-header">
<ol class="breadcrumbs" itemscope itemtype="https://schema.org/BreadcrumbList">
    <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
      <a itemprop="item" href="http://localhost:1313/">
        <span itemprop="name">Home</span>
      </a>
      <meta itemprop="position" content='1' />
    </li>
    <span>&nbsp»&nbsp</span>
    <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
      <a itemprop="item" href="http://localhost:1313/posts/">
        <span itemprop="name">Posts</span>
      </a>
      <meta itemprop="position" content='2' />
    </li>
    <span>&nbsp»&nbsp</span>
</ol>
<h1>Mi mayor aporte a la seguridad informática</h1><time class="dim" datetime="2007-10-30T08:25:11-03:00">October 30, 2007</time><div class="term-container"><div class="tag">
        <a href="http://localhost:1313/tag/seguridad/">#seguridad</a>
      </div><div class="tag">
        <a href="http://localhost:1313/tag/md5/">#md5</a>
      </div><div class="tag">
        <a href="http://localhost:1313/tag/criptograf%C3%ADa/">#criptografía</a>
      </div><div class="tag">
        <a href="http://localhost:1313/tag/vulnerabilidades/">#vulnerabilidades</a>
      </div></ol></div>
  <section class="page-section"><p>Escribo este artículo con orgullo y preocupación. Orgullo por el impacto
que logró mi trabajo y preocupación porque, bueno ya van a ver
porque.</p>
<p>El año 2005 escribí un <a href="http://www.codeproject.com/dotnet/HackingMd5.asp">artículo en
codeproject</a> donde
mostré un esquema práctico que explotaba una de las vulnerabilidades
encontradas en ese tiempo al algoritmo MD5. El artículo alcanzó
notoriedad al ser destacado
en <a href="http://it.slashdot.org/article.pl?sid=05%2F09%2F23%2F0618252&amp;tid=172&amp;tid=93&amp;tid=218">Slashdot</a>,
y en <a href="http://www.kriptopolis.org/explotando-las-colisiones-de-md5">Kriptópolis</a>.</p>
<p>Mi artículo original está en inglés y hay un (muy
breve) <a href="http://www.lnds.net/2005/09/explotando_las_colisiones_de_m.html">resumen</a>
en este mismo blog.</p>
<p>La verdad es que no me preocupé much más del tema, y no estaba enterado
de los derroteros que siguió esta prueba de concepto, pero haciendo una
investigación reciente encontré el <a href="http://www.mathstat.dal.ca/~selinger/md5collision/">trabajo de Peter
Selinger</a>, profesor
e investigador de la <a href="http://www.dal.ca/">Universidad de Dalhouse</a> en
Canada que extendió mi esquema aprovechando el resultado de <a href="http://www.stachliu.com/md5coll.c">Patrich
Stach</a>, que permite aprovechar los
posteriores descubrimientos sobre las fallas de este algoritmo.</p>
<p>Otra sorpresa es que este trabajo ha sido mencionado como
una <a href="http://ws.hackaholic.org/slides/AntiForensics-CodeBreakers2006-Translation-To-English.pdf">herramienta anti
forense</a>
en círculos de hackers éticos.</p>
<h3 id="de-que-se-trata-todo-esto-y-que-implicancias-tiene">¿De que se trata todo esto, y que implicancias tiene?</h3>
<p>Les voy a dar un ejemplo.</p>
<p>Cuando ustedes van a un sitio donde se encuentran las imágenes de disco
de Ubuntu encontrarán un archivo llamado MD5SUMS que en el caso de
Ubuntu 7.10 contiene lo siguiente:</p>
<blockquote>
<p>ebf7ad055bc39634065daa10de980d7e *ubuntu-7.10-alternate-amd64.iso
9a4ae3cfd68911a861d094ec834c9b48 *ubuntu-7.10-alternate-i386.iso<br>
61c87943a92bc7bf519da4e2555d6e86 *ubuntu-7.10-desktop-amd64.iso<br>
d2334dbba7313e9abc8c7c072d2af09c *ubuntu-7.10-desktop-i386.iso<br>
43ff753b260729b12c7d21d3a6db8c73 *ubuntu-7.10-server-amd64.iso<br>
7d88cd87df509a740d9f47b9bbf1375e *ubuntu-7.10-server-i386.iso<br>
5308a79f5e652edba5be84644ee14b09 *ubuntu-7.10-server-sparc.iso</p></blockquote>
<p>La serie de numeros y letras a la izquierda de cada nombre nos indica el
valor resultante al aplicar el algoritmo MD5 al archivo de la derecha.</p>
<p>En este caso, para la imagen del CD ubuntu-7.10-desktop-i386.iso el
valor MD5 es d2334dbba7313e9abc8c7c072d2af09c.</p>
<p>Para validar de que nuestra imagen es la correcta, lo más seguro es
aplicar un cálculo del hash MD5 en el archivo descargado y comprobar que
coincida con lo informado en el sitio oficial de Ubuntu. Si estos
valores coinciden sabemos que el disco no ha sido saboteado ni alterado
por nadie.</p>
<p>Esto impide que un hacker malicioso pueda infectar Ubuntu con un virus o
un trojano, ya que el hacker tendría que crear una imagen iso similar,
reemplazarla en el servidor y asegurarse de que que el valor MD5 de su
archivo coincida con lo informado por Ubuntu.</p>
<p>Hasta ahora eso parecía imposible, pero como demostré en el 2005 es muy
sencillo escribir un programa extractor que burlara este mecanismo de
verificación, aprovechando los fallos al algoritmo MD5 (descubiertos en
ese tiempo por Xiaoyun Wang and Hongbo Yu de la Universidad de Shandong
en China).</p>
<p>El problema con mi esquema es que requiere la distribución del programa
extractor, pero la prueba de concepto de Selinger elimina esta traba.</p>
<p>Selinger es capaz de crear un programa &ldquo;auto extractor&rdquo;, con lo que
deja inutilzable la &ldquo;firma MD5&rdquo; como medio de validación de la
integridad de los <strong>archivos</strong>.</p>
<p>Si pensamos en los <strong>archivos</strong> ISO con que se distribuyen las imagenes
vivas de Ubuntu, y otros sistema operativos, estos <strong>archivos</strong> son
&ldquo;auto ejecutables&rdquo;, y por lo tanto aplica el esquema propuesto por
Selinger.</p>
<p>La puerta está abierta para distribuir troyanos infectando cualquier
distribución de linux que use MD5 como <strong>único mecanismo de
validación</strong><sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>.</p>
<p>No es dificil imaginar una extensión al programa de Salinger para genera
imagenes ISO maliciosas de muchos sistema operativos distribuidos de
esta manera.</p>
<p>Por supuesto esta prueba de concepto también inhabilita el uso
de MD5 como base para construir MAC (Message Autentication Code) en
registros, transacciones o documentos digitales.</p>
<p>En este caso es más sencillo romper este mecanismo de control, porque
los MACs siempre son ejecutados por programas externos, y para esto
basta usar un esquema como el que describí en mi artículo original.</p>
<p>Han pasado 2 años de que sabemos estas cosas y aún me encuentro con
implementaciones en que usan MD5 como un mecanismo de autenticar
transacciones.<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup></p>
<p>Pero lo peor, es que todavía me topo con sistemas que proclaman su alto
nivel de seguridad porque las claves de sus usuarios son almacenadas
en MD5, algo no recomendado antes del 2005, y que aún sigue usándose.</p>
<p>¿Entienden ahora por qué aparte de orgullo siento preocupación?</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>Insisto en lo de único mecanismo de verificación, porque en muchos
casos se usan otras códigos de autenticación adicionales o
complementarios, como firmas PGP o dos valores de hash, uno MD5 y
otro SHA-1 por ejemplo.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p>Lamentablemente muchos usuarios no saben o no se preocupan de
verificar la integridad de las imágenes de los <strong>archivos</strong> descargados,
así que muchas veces los hackers no necesitan algo tan complicado para
vulnerar la distribución de sofware.&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>
</section></main>
        <footer id="main-footer"><div class="footer">
  <a href="#">Scroll to Top</a>
  <div class="footer-copyright">
    <div class="dim">© 2025 Eduardo Díaz</div>
    <div>Made with ❤️ and powered by <a href="https://github.com/math-queiroz/rusty-typewriter" target="_blank">Rusty Typewriter</a> theme for <a href="https://gohugo.io/" target="_blank">Hugo</a></div>
  </div>
</div>
</footer>
      </div><aside id="side-pane" class="side-sticky"><div class="side-details">
    <span>744 words</span>
    <span>5 - 6 minutes read</span></div><h3>Table Of Contents</h3><nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#de-que-se-trata-todo-esto-y-que-implicancias-tiene">¿De que se trata todo esto, y que implicancias tiene?</a></li>
      </ul>
    </li>
  </ul>
</nav><h3>Related</h3>
    <ul><li><a href="/blog/lnds/2005/08/25/usando-one-way-hash/">Usando one-way hash</a></li><li><a href="/blog/lnds/2005/08/20/integrar-o-desarrollar/">¿Integrar o Desarrollar? </a></li><li><a href="/blog/lnds/2005/08/19/adios-a-sha-1/">Adios a SHA-1</a></li><li><a href="/blog/lnds/2007/02/09/apuntes-sobre-ciber-socialismo-i/">Apuntes sobre Ciber Socialismo I</a></li><li><a href="/blog/lnds/2006/07/11/vigilando-la-red-en-busca-de-terroristas/">Vigilando la red en busca de terroristas</a></li></ul></aside></div>
  </div>
</body>
</html>
