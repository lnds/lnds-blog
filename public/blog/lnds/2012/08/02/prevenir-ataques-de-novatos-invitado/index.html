<!DOCTYPE html>
<html lang="es-cl" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Prevenir Ataques de Novatos (invitado) | La Naturaleza del Software</title>
<link rel="icon" href="/favicon.svg" sizes="any" type="image/svg+xml" /><meta property="og:url" content="http://localhost:1313/blog/lnds/2012/08/02/prevenir-ataques-de-novatos-invitado/">
  <meta property="og:site_name" content="La Naturaleza del Software">
  <meta property="og:title" content="Prevenir Ataques de Novatos (invitado)">
  <meta property="og:description" content="Durante este mes de aniversario tendremos el aporte de varios amigos que han aceptado amablemente enviar sus contribuciones a este post. Empezaremos con este interesante y muy útil artículo escrito por Daniel Molina Wegener (@damowe), arquitecto de software, gran programador, y autor de coder.cl.
¡Gracias Daniel! Los dejo disfrutando de este excelente post (al menos yo voy a revisar este sitio y aplicar algunos de estos consejos):
prevenir ataques de novatos por Daniel Molina Wegener">
  <meta property="og:locale" content="es_cl">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2012-08-02T22:25:11-03:00">
    <meta property="article:modified_time" content="2012-08-02T22:25:11-03:00">
    <meta property="article:tag" content="Seguridad">
    <meta property="article:tag" content="Blogging">
    <meta property="article:tag" content="Villano Invitado">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Prevenir Ataques de Novatos (invitado)">
  <meta name="twitter:description" content="Durante este mes de aniversario tendremos el aporte de varios amigos que han aceptado amablemente enviar sus contribuciones a este post. Empezaremos con este interesante y muy útil artículo escrito por Daniel Molina Wegener (@damowe), arquitecto de software, gran programador, y autor de coder.cl.
¡Gracias Daniel! Los dejo disfrutando de este excelente post (al menos yo voy a revisar este sitio y aplicar algunos de estos consejos):
prevenir ataques de novatos por Daniel Molina Wegener">

    <link rel="stylesheet" href="/css/root.css">
    <link rel="stylesheet" href="/css/bundle.css">

      <script src="/js/bundle.js"></script><script defer src="/js/search/flexsearch.compact.64594b125f7b78bdf4fa8316955922bbebb1cd6baef3f16654bfca20309f18f8.js" integrity="sha256-ZFlLEl97eL30&#43;oMWlVkiu&#43;uxzWuu8/FmVL/KIDCfGPg="></script>
<script defer src="/js/search/search.1d980f84df11f3eb7c8c5f17f541d49a0611608df179dd74fa7f06225eb56ace.js" integrity="sha256-HZgPhN8R8&#43;t8jF8X9UHUmgYRYI3xed10&#43;n8GIl61as4="></script>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Spectral:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,200..800&family=Spectral:ital,wght@0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap" rel="stylesheet">

</head>
<body class="notransition">
  <div id="container">
    <header id="main-header"><div role="navigation" aria-label="Main">
  <div class="nav-left">
    <a href="http://localhost:1313/" style="color: inherit;">La Naturaleza del Software</a>
  </div>
  <div class="nav-right">
    <div style="position:absolute;width:0px;height:0px;">
      <div id="nav-dropdown-menu" class="hidden" href="#">
    <div class="nav-item">
      <a aria-current="true" class="ancestor" href="/posts/"
      >Posts</a>
    </div>
    <div class="nav-item">
      <a href="https://Newsletter.lnds.net"
      >Newsletter</a>
    </div>
    <div class="nav-item">
      <a href="/books/"
      >Books</a>
    </div>
    <div class="nav-item">
      <a href="/about/"
      >About</a>
    </div>
</div>
    </div>
    <a id="nav-dropdown-button" href="#"><svg width="20px" height="20px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M4 6H20M4 12H20M4 18H20" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</a>
    <div id="nav-menu">
    <div class="nav-item">
      <a aria-current="true" class="ancestor" href="/posts/"
      >Posts</a>
    </div>
    <div class="nav-item">
      <a href="https://Newsletter.lnds.net"
      >Newsletter</a>
    </div>
    <div class="nav-item">
      <a href="/books/"
      >Books</a>
    </div>
    <div class="nav-item">
      <a href="/about/"
      >About</a>
    </div>
</div>
    <a id="theme-switcher" href="#">
<svg class="light-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M12 3V4M12 20V21M4 12H3M6.31412 6.31412L5.5 5.5M17.6859 6.31412L18.5 5.5M6.31412 17.69L5.5 18.5001M17.6859 17.69L18.5 18.5001M21 12H20M16 12C16 14.2091 14.2091 16 12 16C9.79086 16 8 14.2091 8 12C8 9.79086 9.79086 8 12 8C14.2091 8 16 9.79086 16 12Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>

<svg class="dark-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M3.32031 11.6835C3.32031 16.6541 7.34975 20.6835 12.3203 20.6835C16.1075 20.6835 19.3483 18.3443 20.6768 15.032C19.6402 15.4486 18.5059 15.6834 17.3203 15.6834C12.3497 15.6834 8.32031 11.654 8.32031 6.68342C8.32031 5.50338 8.55165 4.36259 8.96453 3.32996C5.65605 4.66028 3.32031 7.89912 3.32031 11.6835Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
</svg>
</a>
  </div>
</div>
</header>
    <div class="flex grow">
      <div id="main-pane">
        <main id="main-content"><div class="single-header">
<ol class="breadcrumbs" itemscope itemtype="https://schema.org/BreadcrumbList">
    <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
      <a itemprop="item" href="http://localhost:1313/">
        <span itemprop="name">Home</span>
      </a>
      <meta itemprop="position" content='1' />
    </li>
    <span>&nbsp»&nbsp</span>
    <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
      <a itemprop="item" href="http://localhost:1313/posts/">
        <span itemprop="name">Posts</span>
      </a>
      <meta itemprop="position" content='2' />
    </li>
    <span>&nbsp»&nbsp</span>
</ol>
<h1>Prevenir Ataques de Novatos (invitado)</h1><time class="dim" datetime="2012-08-02T22:25:11-03:00">August 2, 2012</time><div class="term-container"><div class="tag">
        <a href="http://localhost:1313/tag/seguridad/">#seguridad</a>
      </div><div class="tag">
        <a href="http://localhost:1313/tag/blogging/">#blogging</a>
      </div><div class="tag">
        <a href="http://localhost:1313/tag/villano-invitado/">#villano invitado</a>
      </div></ol></div>
  <section class="page-section"><p>Durante este mes de aniversario tendremos el aporte de varios amigos que
han aceptado amablemente enviar sus contribuciones a este post.
Empezaremos con este interesante y muy útil artículo escrito por Daniel
Molina Wegener (<a href="https://twitter.com/damowe">@damowe</a>), arquitecto de
software, gran programador, y autor de <a href="http://coder.cl/">coder.cl</a>.</p>
<p>¡Gracias Daniel! Los dejo disfrutando de este excelente post (al menos
yo voy a revisar este sitio y aplicar algunos de estos consejos):</p>
<h2 id="prevenir-ataques-de-novatos">prevenir ataques de novatos</h2>
<p>por <a href="http://coder.cl/">Daniel Molina Wegener</a></p>
<p>Soy programador, me gusta programar. Ese ha sido mi foco profesional
durante muchos años. Me gusta tanto que ya manejo mas de 10 lenguajes de
programación y actualmente trabajo en una empresa que usa mis servicios
de programación en Assembler, C, C++, Haskell, Lisp, Python y Java. Mi
preocupación no es sólo aprender lenguajes, hay un trasfondo teórico
importante tras cada lenguaje, y muchas cosas no son puestas al azar y
tienen un marco teórico importante en la Ciencia de la Computación, y
muchas veces matemático. Finalmente, mi tercera preocupación es como
organizar el desempeño de varios lenguajes dentro de una arquitectura
determinada. Esto me lleva a un área de desarrollo de habilidades
conocida como administración de sistemas.</p>
<p>Hace unos días atrás, se convocó la acción de Anonymous por medio de una
de sus operaciones acá en Chile. Como tengo varios amigos que tienen
servidores, frecuentemente recibo preguntas respecto a qué ocurrió con
determinada página y cómo lograron <em>cambiar</em> la página original desde
afuera. Creo que el <strong>95%</strong> de los ataques a servidores son iguales. Un
sujeto no muy habil usa servidores muy pobremente administrados fuera de
su país de origen para lanzar ataques prefabricados por extranjeros &mdash;
donde incluso se pueden ver las firmas en los desarrolladores de ataques
en los requerimientos que hacen a los servidores &mdash; y tratan de
explotar, típicamente, las extensiones instaladas en administradores de
contenido, donde muchas veces son hechas por diseñadores y no
programadores, con varios errores en la validación de datos usados por
estas extensiones, como por ejemplo extensiones con capacidad de subir
archivos con muy poco control.</p>
<p>El otro detalle es que el único beneficiado con la última acción de este
tipo de acciones, donde muchos servidores no tienen relación alguna con
los objetivos que lo convocaron &mdash; como un restaurante de sushi y
sitios similares. El simple hecho de iniciar este tipo de ataques sobre
sitios que no tienen relación alguna con el objetivo que convocó
la <em>operación</em> me hace pensar que no son mas que crackers &mdash; para mi no
son hackers, un hacker es un programador muy hábil o un especialista muy
hábil en su area.</p>
<p>Pero evitar este tipo de ataques no es una tarea tan compleja, y creo
que cualquier administrador de sistemas puede proteger sus servidores
contra un número importante de este tipo de ataques y los
desarrolladores a cargo de las plataformas pueden analizar el software
que están usando para evitarlos. Cada sistema tiene alguna forma de ser
protegido en alguna medida. No basta con tener un firewall, se deben
considerar otros aspectos. A continuación voy a presentar algunos
consejos para proteger servidores con software de libre disposición &mdash;
principalmente servidores Linux y similares.</p>
<p><img src="wolf-blocking.jpg" alt=""></p>
<h3 id="uploads-y-mod_rewrite">uploads y mod_rewrite</h3>
<p>Si usted es de las personas que usa extensiones para administradores de
contenido sin revisar el código que esta instalando, lo primero que debe
realizar es revisar que directorios se utilizan para subir archivos en
este gestor de contenido y que módulos esta usando el servidor para
interpretar lenguajes. Si el servidor web cuenta con un interprete de
PHP, pueden subir un shell remoto escrito en PHP que pueda servir como
explorador remoto de archivos. Tomemos un ejemplo de un CMS que usa el
directorio /uploads para almacenar los archivos subidos &mdash; como las
imágenes.</p>
<blockquote>
<pre><code>ErrorDocument     404     &quot;404 - : (&quot;
ErrorDocument     403     &quot;403 - : (&quot;

&lt;IfModule mod_rewrite.c&gt;

RewriteEngine     On
RewriteBase       /

RewriteCond       %{REQUEST_METHOD}         !^(HEAD|GET|OPTIONS|POST)$
RewriteRule       (.*)                      [F,NS,L]

RewriteCond       %{REQUEST_FILENAME}       ^.*uploads.*\.(py|php|pl|cgi|bin|sh)$
RewriteRule       (.*)                      [F,NS,L]

RewriteCond       %{REQUEST_FILENAME}       ^.*users.*\.(py|php|pl|cgi|bin|sh)$
RewriteRule       (.*)                      [F,NS,L]

RewriteCond       %{REQUEST_FILENAME}       !-f
RewriteRule       .                         /index.php [L]

&lt;/IfModule&gt;
</code></pre></blockquote>
<p>En el ejemplo anterior, si los verbos HTTP son distintos a los 4 verbos
que comúnmente usan los browsers (head, get, post y options), el
servidor envía un error HTTP 403 y termina el requerimiento. Si pasa
esta regla, revisa que si el requerimiento va dirigido al directorio que
contenga uploads y aplica lo mismo a users, y éste no debe terminar con
las extensiones py, php, pl, cgi, bin y sh, bloqueando cualquier script
que sea puesto en este directorio. Finalmente permite cualquier
requerimiento a archivos, y en caso contrario, direcciona el
requerimiento a index.php. Con esto se evita el dolor de cabeza que
implica instalar una extensión para administradores de contenido que
estén mal programadas y que permitan subir archivos. Las directivas para
documento de error reducen el tamaño de los documentos de error a unos
cuantos bytes.</p>
<h3 id="ataquescomunesymod_security">ataques comunes y mod_security</h3>
<p>Los ataques prefabricados están en su mayoría cubiertos
por mod<em>security. Pero el conjunto de reglas básico no es suficiente, lo
mejor para este módulo es usar el conjunto de reglas de pago, que se
manejan a modo de
suscripción <a href="http://www.modsecurity.org/projects/commercial/rules/">suscripción</a> que
permite tener reglas comerciales actualizadas. Esto bloqueará un buen
número de ataques, como _sql injection</em> por ejemplo, principalmente
esos ataques hacia bugs que aun no tienen fixes por parte de los
fabricantes de software.</p>
<h3 id="ataquesddosymod_evasive">ataques DDoS y mod_evasive</h3>
<p>Este módulo permite evitar que el servidor se sobrecargue con ataques
del tipo DDoS bloqueando las direcciones IP que concurren en forma
frecuente al servidor y no tienen el comportamiento típico de un usuario
navegando &mdash; por ejemplo al hacer mas de 5 requerimientos simultáneos
como lo hace un browser. El
módulo <a href="http://www.zdziarski.com/blog/?page_id=442">mod_evasive</a>bloqueará
los requerimientos poco comunes protegiendo al servidor de
requerimientos concurrentes como un synflood y similares.</p>
<h3 id="bloquearescaneodepuertos">bloquear escaneo de puertos</h3>
<p>Bloquear el escaneo de puertos es bastante simple, en el servidor se
debe omitir el uso de ciertos servicios. Por ejemplo esta claro que el
protocolo FTP no se debe usar de ninguna manera. Sabiendo esto, podemos
usar <a href="http://sentrytools.sourceforge.net/">PortSentry</a> para bloquear
usuarios curiosos. Si el servidor es un servidor Web y el único servicio
importante en el servidor hacia el público se da pos los puertos 80 HTTP
y 443 HTTPS, podemos abrir los puertos 20 FTP, 21 FTP y 25 SMTP y dar el
paso a PortSentry para que los vigile. De esta forma PortSentry
bloqueará a los usuarios curiosos que estén husmeando el servidor donde
no corresponde. Basta con que el usuario trate de conectarse al puerto
20 y 21 para que PortSentry lo deje bloqueado desde el firewall interno
del sistema operativo, o también se podría integrar con otros sistemas
de gestión de redes y bloquearlo desde el firewall externo.</p>
<h3 id="fuerzabrutahaciassh">fuerza bruta hacia SSH</h3>
<p>Podemos bloquear los ataques de fuerza bruta hacia servidores SSH &mdash; y
es recomendable que no se use el puerto 22 ya que este es frecuentemente
escaneado por bots &mdash; usando algún monitor
como <a href="http://denyhosts.sourceforge.net/">DenyHosts</a>. También es
recomendable que se usen llaves con contraseñas extensas en lugar de
contraseñas directas en el servidor y el acceso para el usuario
administrador &mdash; como root y operator &mdash; sea bloqueado, donde los
usuarios autorizados a entrar y administrar el servidor estén
registrados como sudoers.</p>
<h3 id="ofuscarjavascript">ofuscar JavaScript</h3>
<p>Nunca dejes JavaScript dentro del HTML y ofusca todo el JavaScript del
sitio centralizándolo dentro de uno o varios archivos. Hay varias
herramientas que puedes usar para esto, como <a href="http://developer.yahoo.com/yui/compressor/">YUI
Compressor</a>. Esto evitará
que el JavaScript pueda ser analizado por inexpertos, principalmente
cuando el JavaScript permite realizar algunos ataques como XSS. Lo mismo
aplica al CSS, puedes
usar <a href="http://csstidy.sourceforge.net/">CSSTidy</a> para comprimir el CSS de
tu sitio. Esto hará que los inexpertos se pierdan por un buen rato.</p>
<h3 id="queencontrenlosservidores">que encontré en los servidores</h3>
<p>En los servidores encontré muchos de estos ataques comunes y al menos
los servidores que yo administro, donde aplico este software y
similares, además de buenas prácticas administrativas, no sufrieron daño
alguno. Una buena forma de filtrar el log de Apache, por ejemplo
buscando ataques sobre un blog Wordpress, es ejecutar el siguiente
comando sobre el log de acceso en apache:</p>
<blockquote>
<pre><code>grep POST access.empresa.log | sed '/wp-login/d; /wp-comments/d; /wp-cron/d; /trackback/d;'
</code></pre></blockquote>
<p>Uno encuentra cosas interesantes con este comando, como por ejemplo esos
ataques comunes a las extensiones Wordpress que permite la subida de
archivos al blog, pero que pueden ser bloqueados con un par de reglas
de mod_rewrite, como estos por ejemplo, que fueron ejecutados sobre un
blog Wordpress:</p>
<blockquote>
<pre><code>XXX.XXX.XXX.XXX - - [30/Jul/2012:21:11:56 -0400] &quot;POST //wp-content/plugins/ajax_multi_upload/upload.php HTTP/1.1&quot; 403 23716 &quot;-&quot; &quot;Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)&quot;
XXX.XXX.XXX.XXX - - [30/Jul/2012:21:12:04 -0400] &quot;POST /wp-content/plugins/auctionPlugin/uploadify/upload.php HTTP/1.1&quot; 403 23721 &quot;-&quot; &quot;Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)&quot;
XXX.XXX.XXX.XXX - - [30/Jul/2012:21:12:12 -0400] &quot;POST /wp-content/plugins/wpstorecart/php/upload.php HTTP/1.1&quot; 403 23713 &quot;-&quot; &quot;Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)&quot;
</code></pre></blockquote>
<p>La mayoría de los ataques se pueden prevenir con una buena configuración
de los servidores y el conjunto de aplicaciones y módulos presentados
acá están disponibles en los sistemas operativos como parte del sistema.
Basta con instalarlos y usar el pago sugerido cuando corresponda.</p>
</section></main>
        <footer id="main-footer"><div class="footer">
  <a href="#">Scroll to Top</a>
  <div class="footer-copyright">
    <div class="dim">© 2025 Eduardo Díaz</div>
    <div>Made with ❤️ and powered by <a href="https://github.com/math-queiroz/rusty-typewriter" target="_blank">Rusty Typewriter</a> theme for <a href="https://gohugo.io/" target="_blank">Hugo</a></div>
  </div>
</div>
</footer>
      </div><aside id="side-pane" class="side-sticky"><div class="side-details">
    <span>1492 words</span>
    <span>9 - 12 minutes read</span></div><h3>Table Of Contents</h3><nav id="TableOfContents">
  <ul>
    <li><a href="#prevenir-ataques-de-novatos">prevenir ataques de novatos</a>
      <ul>
        <li><a href="#uploads-y-mod_rewrite">uploads y mod_rewrite</a></li>
        <li><a href="#ataquescomunesymod_security">ataques comunes y mod_security</a></li>
        <li><a href="#ataquesddosymod_evasive">ataques DDoS y mod_evasive</a></li>
        <li><a href="#bloquearescaneodepuertos">bloquear escaneo de puertos</a></li>
        <li><a href="#fuerzabrutahaciassh">fuerza bruta hacia SSH</a></li>
        <li><a href="#ofuscarjavascript">ofuscar JavaScript</a></li>
        <li><a href="#queencontrenlosservidores">que encontré en los servidores</a></li>
      </ul>
    </li>
  </ul>
</nav><h3>Attachments</h3>
    <ul><li><a href="http://localhost:1313/blog/lnds/2012/08/02/prevenir-ataques-de-novatos-invitado/wolf-blocking.jpg">wolf-blocking.jpg</a></li></ul><h3>Related</h3>
    <ul><li><a href="/blog/lnds/2012/08/01/septimo-aniversario/">Séptimo Aniversario</a></li><li><a href="/blog/lnds/2012/04/13/about-speed-hashing/">About Speed Hashing</a></li><li><a href="/blog/lnds/2012/02/24/seguridad-y-oportunidad/">Seguridad y oportunidad</a></li><li><a href="/blog/lnds/2012/02/21/sobre-la-seguridad/">Sobre la Seguridad</a></li><li><a href="/blog/lnds/2011/10/22/el-espejismo-de-la-seguridad/">El Espejismo de la Seguridad</a></li></ul></aside></div>
  </div>
</body>
</html>
